% zhou.lv.wen@gmail.com

lat = [ 39.54  31.14  39.09  29.32  45.45 ...	   
        43.52  41.50  40.49  38.02  37.52 ...	
        36.38  34.48  34.16  36.03  38.20 ...	
        36.38  43.48  31.51  32.02  30.14 ...	
        28.11  28.41  30.37  30.39  26.35 ...	
        26.05  23.08  20.02  22.48  25.00 ...
        29.39  22.18  22.14  25.03          ];

lon = [116.28 121.29 117.11 106.32 126.41 ...	  
       125.19 123.24 111.48 114.28 112.34 ...
       117.00 113.42 108.54 103.49 106.16 ...	
       101.45  87.36 117.18 118.50 120.09 ...
       113.00 115.52 114.21 104.05 106.42 ...	
       119.18 113.15 110.20 108.20 102.41 ...
        90.08 114.10 113.35 121.31          ];

n = length(lat);

R = 6378.137;

dist = zeros(n);
for i = 1:n
    for j = i+1:n
        dist(i,j) = distance(lat(i),lon(i), lat(j),lon(j), R);
    end
end

dist = dist + dist';
[order,totdist] = minhamiltonpath(dist)

plot(lon(order([1:end,1])), lat(order([1:end,1])),'r-','linewidth',2)


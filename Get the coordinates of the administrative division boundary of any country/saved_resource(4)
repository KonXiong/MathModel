!function(){var e=!1;_.Module.define({path:"common/widget/detectManagerBlock",requires:["common/widget/verifyManagerPhone"],sub:{initial:function(){},setBlockState:function(n){e=n},getBlockState:function(){return e},doOnNotBlocked:function(n,o){void 0===o&&(o=!0),e?o&&this.requireInstance("common/widget/verifyManagerPhone",[!0]):n()},doOnBlocked:function(n){e&&n()}}})}();_.Module.define({path:"common/widget/blockUser",requires:["common/widget/detectManagerBlock"],sub:{template:'<div class="block_user_wrapper"> <ul class="b_u_items">   <li class="b_u_items_outer">  <label>\u5C01\u7981\u8D26\u6237</label><div class="b_username" ></div> </li>  <li class="b_u_items_outer">    <label>\u5C01\u7981\u65F6\u957F:</label>  <div class="b_block_time"> <span class="b_fixed_time">1\u5929</span>   <select class="b_select_time"> <option data-info="1">1\u5929</option> <option data-info="3">3\u5929</option><option data-info="10">10\u5929</option>  </select>  </div>   </li>  <li class="b_u_items_outer"> <label>\u5C01\u7981\u539F\u56E0:</label> <div class="b_reason_box"><ul class="b_reason_ul">   <li class="b_reason_item" data-prefix="1."></li><li class="b_reason_item" data-prefix="2."></li> <li class="b_reason_item" data-prefix="3."></li>  <li class="b_reason_item" data-prefix="4."></li>  <li class="b_reason_item" data-prefix="5."></li> <li class="b_reason_item" data-prefix="6."></li>  </ul><div class="b_reason_content">    <div class="b_reason_top">   <div class="b_top_mod_bar" > <div class="b_mod_bar"><span></span>\u4FEE\u6539</div>  <div class="b_del_bar"><span></span>\u5220\u9664</div>   </div><div class="b_top_save_bar">  <div class="b_save_bar"><span></span>\u4FDD\u5B58</div> <div class="b_cancel_bar"><span></span>\u53D6\u6D88</div></div>     </div>   <div class="b_reason_textarea">  <label for="b_user_textarea" class="b_label_tips">\u62B1\u6B49\uFF0C\u4F60\u7684\u53D1\u8D34\u64CD\u4F5C\u6216\u53D1\u8868\u8D34\u5B50\u7684\u5185\u5BB9\u8FDD\u53CD\u4E86\u672C\u5427\u7684\u5427\u89C4\uFF0C\u5DF2\u7ECF\u88AB\u5C01\u7981\uFF0C\u5C01\u7981\u671F\u95F4\u4E0D\u80FD\u5728\u672C\u5427\u7EE7\u7EED\u53D1\u8A00\u3002</label><textarea id="b_user_textarea" class="b_textarea"></textarea>      </div>    </div>   </div>   </li>   </ul>   <div class="block_btns">  <div class="block_tips"></div> <div class="b_id_btn">\u5C01\u7981ID</div> <div class="b_fixed_tips"></div>  </div> </div>',errTemplate:'<div class="block_response_info"></div> ',initial:function(e,a,t,i,n){var o=this,s=o.requireInstance("common/widget/detectManagerBlock",[]);s.doOnNotBlocked(function(){o._block(e,a,t,i,n)})},_block:function(e,a,t,i,n){this.config={block_reason_list:"/pmc/tpl",add_block_reason:"/pmc/tpl",modify_block_reason:"/pmc/tpl",del_block_reason:"/pmc/tpl",save_block_id:"/pmc/blockid"},this.blockList=$.extend(!0,[],e),this.power=a,this.forum=t,this.tbs=i,this.sucCallback=n,this.user_num=this.blockList.length,this.add_new_temp="<span>+</span>\u65B0\u5EFA\u6A21\u677F",this.textarea_maxlength=200,this.curr_pattern="";var o=window.PageData||{},s=o.power||{};this.isManager=(a.ban_id&&a.ban_ip||a.can_filter_id&&a.can_filter_ip)&&!s.can_type4_audit_post&&!s.can_type5_audit_post,this.isSmallManager=("undefined"==a.can_filter_id?!a.ban_id||!a.ban_ip:!a.can_filter_id||!a.can_filter_ip)||(a.ban_id&&a.ban_ip||a.can_filter_id&&a.can_filter_ip)&&s.can_type5_audit_post,this.$blockPopWinHtml=$(this.template),this.$responseBlockInfo=$(this.errTemplate),this.paramValidate(),this.setBlockDefaultInfo(),this.textareaKeyupEvtBind(),this.blockIDbtnEvtBind(),this.tabSwitchEvtBind(),this.textareaFocusEvtBind(),this.textareaBlurEvtBind(),this.logicalControl(),this.blockDialog.show(),this.trigger("show")},duplicateRemoval:function(e){for(var a={},t=[],i=e.length,n=0;i>n;n++)a[e[n]]||(t.push(e[n]),a[e[n]]=!0);return t},paramValidate:function(){var e=this;null===e.power.ban_id||null===e.power.ban_ip||""===e.power.ban_id||""===e.power.ban_ip?(this.blockDialog=new $.dialog({title:"\u5C01\u7981\u63D0\u793A",width:"556",html:this.$responseBlockInfo}),e.$responseBlockInfo.find(".block_response_info").html("\u4F60\u6CA1\u6709\u5C01\u7981\u64CD\u4F5C\u6743\u9650\uFF01")):e.blockDialog=new $.dialog({title:"\u5C01\u7981\u64CD\u4F5C",width:"556",html:this.$blockPopWinHtml}),e.blockDialog.bind("onclose",function(){e.user_num>1&&$.tb.location.reload()}),e.blockDialog.bind("onhide",function(){e.user_num>1&&$.tb.location.reload()})},insertDefaultNewTemp:function(){var e=this,a=0,t=0,i=!1;if($(".b_reason_ul .b_reason_item").each(function(e,i){$(i).hasClass("b_add_new_reason")||($(i).data("reasonId")&&""!=$(i).data("reasonId")&&$(i).data("isBuiltinTpl")===!1&&a++,t++)}),6>a){$(".b_reason_ul .b_reason_item").each(function(a,n){i&&$(".b_reason_ul .b_reason_item").eq(a).remove(),""!==$(n).html().trim()||i||($(n).tbattr("data-is-builtin-tpl",!1).tbattr("data-prefix",t),$(n).addClass("b_add_new_reason").append(e.add_new_temp),i=!0)});var n=$(".b_reason_ul .b_add_new_reason").length;0==n&&$(".b_reason_ul").append('<li class="b_reason_item b_add_new_reason" data-is-builtin-tpl="false" data-prefix="'+(t+1)+'.">'+e.add_new_temp+"</li>")}},setTextareaVal:function(){var e=this;0!=e.$blockPopWinHtml.find(".b_reason_curr").length||e.$blockPopWinHtml.find(".b_reason_item").eq(0).hasClass("b_add_new_reason")||e.$blockPopWinHtml.find(".b_reason_item").eq(0).addClass("b_reason_curr");var a=e.$blockPopWinHtml.find(".b_reason_curr");if(a.hasClass("b_add_new_reason"))e.$blockPopWinHtml.find(".b_textarea").val("");else if(a.html()){var t=a.html(),i=2;a.data("prefix")>=10&&(i=3),e.$blockPopWinHtml.find(".b_textarea").val(t.substr(i,t.length))}},noReasonCantModify:function(){var e=0,a=this;a.$blockPopWinHtml.find(".b_reason_item").each(function(a,t){"undefined"!=typeof $(t).tbattr("data-reason-id")&&e++}),0==e&&(a.$blockPopWinHtml.find(".b_add_new_reason").removeClass("b_reason_curr"),a.$blockPopWinHtml.find(".b_reason_top").hide(),""==a.$blockPopWinHtml.find(".b_textarea").val()&&a.$blockPopWinHtml.find(".b_label_tips").show())},setBlockReasonList:function(){var e=this,a=!1;$.ajax({url:e.config.block_reason_list,type:"POST",dataType:"json",data:{fid:e.forum.forum_id,tbs:e.tbs},success:function(t){if("0"==t.errno){var i=t.data;if(0==i.length)e.$blockPopWinHtml.find(".b_label_tips").show(),e.$blockPopWinHtml.find(".b_textarea").val(""),e.noReasonCantModify(),e.$blockPopWinHtml.find(".b_reason_item").each(function(e,a){$(a).removeAttr("data-reason-id").html("")}),e.$blockPopWinHtml.find(".b_reason_item").removeClass("b_reason_curr");else{var n=e.$blockPopWinHtml.find(".b_reason_item").length,o=i.length,s=o-n;if(s>0){for(var l=n,r="";s>0;)r+='<li class="b_reason_item" data-prefix="'+(l+1)+'." ></li>',l++,s--;$(".b_reason_ul").append(r)}e.$blockPopWinHtml.find(".b_reason_item").each(function(t,n){0==t&&(e.curr_pattern="undefined"!=typeof i[t]?"modify":"add"),"undefined"!=typeof i[t]?$(n).html(t+1+"."+i[t].template_text).tbattr("data-reason-id",i[t].template_id).tbattr("data-is-builtin-tpl",i[t].is_builtin_tpl).tbattr("data-prefix",t+1):$(n).html(""),$(n).hasClass("b_add_new_reason")&&!a&&($(n).removeClass("b_add_new_reason"),a=!0)}),e.$blockPopWinHtml.find(".b_reason_item").each(function(a,t){""==$(t).html()&&e.$blockPopWinHtml.find(".b_reason_item").eq(a).remove(),$(t).hasClass("b_reason_curr")&&($(t).data("isBuiltinTpl")?$(".b_top_mod_bar .b_del_bar").hide():$(".b_top_mod_bar .b_del_bar").show())})}e.isManager&&e.insertDefaultNewTemp(),e.setTextareaVal()}else e.setResponseTips(2,"\u83B7\u53D6\u5C01\u7981\u539F\u56E0\u5217\u8868\u5931\u8D25!")},error:function(a){e.setNewDialogRespTips(2,a)}})},setBlockDefaultInfo:function(){for(var e=this,a=[],t=[],i=0;i<e.blockList.length;++i){var n=e.blockList[i].nickname,o=e.blockList[i].username,s=[n,o].join("|");-1===$.inArray(s,t)&&a.push(n?n:o)}a=a.join(),e.$blockPopWinHtml.find(".b_username").html(a),e.setBlockReasonList()},textareaKeyupEvtBind:function(){var e=this;e.$blockPopWinHtml.find(".b_textarea").on("keyup",function(){var a=$(this).val(),t=$.tb.getByteLength(a),i=e.$blockPopWinHtml.find(".block_tips");i.css({display:"block"}),e.textarea_maxlength-t>0?($(this).hasClass("input_right_pattern")||$(this).addClass("input_right_pattern"),$(this).removeClass("input_error_pattern"),i.html("\u8FD8\u53EF\u8F93\u5165"+parseInt((e.textarea_maxlength-t)/2)+"\u5B57").addClass("b_green")):($(this).hasClass("input_error_pattern")||$(this).addClass("input_error_pattern"),$(this).removeClass("input_right_pattern"),i.removeClass("b_green").addClass("b_red").html("\u5DF2\u8D85\u51FA"+parseInt(parseInt((t-e.textarea_maxlength)/2)+1)+"\u5B57"))})},textareaFocusEvtBind:function(){var e=this;e.$blockPopWinHtml.on("focus.showEditor",".b_textarea",function(){e.curr_pattern="add",e.toogleToolBar(),e.$blockPopWinHtml.find(".block_tips").html("").removeClass("b_red,b_green"),e.$blockPopWinHtml.find(".b_label_tips").css({display:"none"}),e.isManager?e.$blockPopWinHtml.find(".b_reason_top").show():e.$blockPopWinHtml.find(".b_reason_top").hide()})},textareaBlurEvtBind:function(){var e=this;e.$blockPopWinHtml.on("click",function(a){var t=$(a.target);if(0==t.closest(".b_reason_box").length){e.curr_pattern="modify",e.toogleToolBar(),0==e.$blockPopWinHtml.find(".b_reason_curr").length&&e.$blockPopWinHtml.find(".b_reason_top").hide();var i=e.isSmallManager;i&&(""==e.$blockPopWinHtml.find(".b_textarea").val()?e.$blockPopWinHtml.find(".b_label_tips").show():e.$blockPopWinHtml.find(".b_label_tips").hide()),e.$blockPopWinHtml.find(".block_tips").html(""),e.noReasonCantModify()}})},modifyTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_mod_bar").on("click",function(){e.$blockPopWinHtml.find(".b_textarea").trigger("focus")})},deleteTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_del_bar").on("click",function(){if("undefined"==typeof e.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id")||e.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")||e.$blockPopWinHtml.find(".b_reason_curr").data("isBuiltinTpl"))return!1;var a={op:"del",id:e.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id"),fid:e.forum.forum_id,tbs:e.tbs};$.ajax({url:e.config.del_block_reason,type:"POST",dataType:"json",data:a,success:function(a){"0"==a.errno?(e.$blockPopWinHtml.find(".b_reason_curr").removeAttr("data-reason-id"),e.setBlockReasonList(),e.setResponseTips(1,"\u5220\u9664\u6210\u529F\uFF01")):e.setResponseTips(2,"\u5220\u9664\u5931\u8D25!")},error:function(a){e.setNewDialogRespTips(2,a)}})})},toogleToolBar:function(){var e=this;e.isManager?(e.$blockPopWinHtml.find(".b_reason_top").css({display:"block"}),"modify"==this.curr_pattern?(e.$blockPopWinHtml.find(".b_top_mod_bar").css({display:"block"}),e.$blockPopWinHtml.find(".b_top_save_bar").css({display:"none"})):"add"==this.curr_pattern&&(e.$blockPopWinHtml.find(".b_top_mod_bar").css({display:"none"}),e.$blockPopWinHtml.find(".b_top_save_bar").css({display:"block"}))):e.$blockPopWinHtml.find(".b_reason_top").css({display:"none"})},saveTextareaCon:function(){var e,a=this,t={},i=a.$blockPopWinHtml.find(".b_textarea");a.$blockPopWinHtml.find(".b_save_bar").on("click",function(){if(!a.checkCanbeBlocked())return!1;var n=a.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")||0==a.$blockPopWinHtml.find(".b_reason_curr").length;n?(t={op:"add",tbs:a.tbs,fid:a.forum.forum_id,ie:"gbk",text:$.tb.escapeHTML(i.val())},e=a.config.add_block_reason):(t={op:"update",tbs:a.tbs,fid:a.forum.forum_id,ie:"gbk",text:$.tb.escapeHTML(a.$blockPopWinHtml.find(".b_textarea").val()),id:a.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id")},e=a.config.modify_block_reason),$.ajax({url:e,type:"POST",dataType:"json",data:t,success:function(e){a.curr_pattern="modify",a.toogleToolBar(),"0"==e.errno?(a.setBlockReasonList(),a.setResponseTips(1,"\u4FDD\u5B58\u6210\u529F\uFF01"),n?$.stats.track("AddReasonItem","uegCount","bawuAppeal","success"):$.stats.track("modifyReasonItem"+$(".b_reason_curr").index(),"uegCount","bawuAppeal","success")):a.setResponseTips(2,"\u4FDD\u5B58\u5931\u8D25!")},error:function(e){a.setNewDialogRespTips(2,e)}})})},cancelTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_cancel_bar").on("click",function(){e.setTextareaVal(),e.curr_pattern="modify",e.toogleToolBar(),e.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")&&e.$blockPopWinHtml.find(".b_reason_item").siblings().removeClass("b_reason_curr").end().eq(0).addClass("b_reason_curr")})},getSavesData:function(e){var a=this,t={};t.day="block"===a.$blockPopWinHtml.find(".b_fixed_time").css("display")?"1":a.$blockPopWinHtml.find(".b_select_time").find("option:selected").tbattr("data-info"),t.fid=a.forum.forum_id,t.tbs=a.tbs,t.ie="gbk",t.user_name=[],t.nick_name=[],t.pid=[],t.portrait=[];for(var i=0;i<a.blockList.length;++i){var n=a.blockList[i];n.portrait?-1===$.inArray(n.portrait,t.portrait)&&(t.user_name.push($.tb.escapeHTML(n.username)),t.nick_name.push($.tb.escapeHTML(n.nickname||"")),t.portrait.push(n.portrait),n.pid&&t.pid.push(n.pid)):(-1===$.inArray(n.username,t.user_name)&&t.user_name.push(n.username),n.pid&&t.pid.push(n.pid))}var o=a.$blockPopWinHtml.find(".b_textarea"),s=0;return a.$blockPopWinHtml.find(".b_reason_item").each(function(e,a){"undefined"==typeof $(a).tbattr("data-reason-id")&&s++}),t.reason=6==s&&""===o.val().trim()?a.$blockPopWinHtml.find(".b_label_tips").html():a.$blockPopWinHtml.find(".b_textarea").val(),t.reason=$.tb.escapeHTML(t.reason),2===e&&(t.ip="1"),t},checkCanbeBlocked:function(){var e=this,a=e.$blockPopWinHtml.find(".b_textarea"),t=0;return a.hasClass("input_error_pattern")||""===a.val().trim()?(e.$blockPopWinHtml.find(".b_reason_item").each(function(e,a){"undefined"==typeof $(a).tbattr("data-reason-id")&&t++}),6==t?!0:(e.$blockPopWinHtml.find(".b_textarea").trigger("focus"),a.hasClass("input_error_pattern")?e.setResponseTips(2,"\u5C01\u7981\u539F\u56E0\u4E0D\u80FD\u8D85\u51FA100\u5B57"):e.setResponseTips(2,"\u5C01\u7981\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"),!1)):!0},blockIDbtnEvtBind:function(){var e=this;e.$blockPopWinHtml.find(".b_id_btn").on("click",function(){if(!e.checkCanbeBlocked())return!1;var a=e.getSavesData(1),t=function(i){a=i?$.extend(a,i):a,$.ajax({url:e.config.save_block_id,type:"POST",dataType:"json",data:a,success:function(a){if(1990055===a.errno)if("undefined"==typeof passport||"undefined"==typeof passport.pop.init){var i="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime(),n="https://passport";$.JsLoadManager.use([n+".baidu.com/passApi/js/uni_login_wrapper.js?cdnversion="+Math.floor(i/6e4),n+".baidu.com/passApi/js/wrapper.js?cdnversion="+Math.floor(i/6e4)],function(){window.realname=passport.pop.init({type:"accRealName",apiOpt:{product:"tb",staticPage:"//tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"},tangram:!0,color:"green"}),window.realname.show()},!0,"utf-8")}else window.realname.show();else"0"==a.errno?(e.setNewDialogRespTips(1,"\u5C01\u7981\u6210\u529F\uFF01"),(e.sucCallback||"function"==typeof e.sucCallback)&&e.sucCallback()):224011==a.errno?e.getCaptcha(a,t,e):e.setNewDialogRespTips(2,a.errmsg||"\u5C01\u7981\u5931\u8D25\uFF01")},error:function(a){e.setNewDialogRespTips(2,a)}})};t()})},getCaptcha:function(e,a,t){var i=this;t=t||i;var n=PageData.forum_name||(PageData.forum?PageData.forum.forum_name:""),o=PageData.forum_id||(PageData.forum?PageData.forum.forum_id:"");this.requireInstanceAsync("common/component/CaptchaDialog",[{title:"\u5C01\u7981",message:"\u5C01\u7981\u4E86\u90A3\u4E48\u591A\u4EBA\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.res.captcha_vcode_str,vCodeType:e.res.captcha_code_type,forumName:n,forumId:o,postType:"thread",paramsCallback:function(){return{}}}],function(e){i.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){var i={vcode:e.getInputValue(),vcode_md5:e.getVCode()};a.call(t,i)}),e.show()})},setResponseTips:function(e,a){var t=this,i=t.$blockPopWinHtml.find(".block_tips");1==e?i.removeClass("b_red").addClass("b_green").html(a):i.removeClass("b_green").addClass("b_red").html(a),window.setTimeout(function(){i.hasClass("b_green")&&i.html("")},2e3)},setNewDialogRespTips:function(e,a){var t=this,i=t.$blockPopWinHtml;i.html(t.$responseBlockInfo),1==e?i.find(".block_response_info").removeClass("b_red").addClass("b_green").html(a):i.find(".block_response_info").removeClass("b_green").addClass("b_red").html(a),window.setTimeout(function(){t.blockDialog.hide(),t.user_num>1&&$.tb.location.reload(),t.trigger("hide")},2e3)},tabSwitchEvtBind:function(){var e=this;e.$blockPopWinHtml.on("click",".b_reason_item",function(){return $(this).data("isBuiltinTpl")?$(".b_top_mod_bar .b_del_bar").hide():$(".b_top_mod_bar .b_del_bar").show(),"undefined"!=typeof $(this).tbattr("data-reason-id")||$(this).hasClass("b_add_new_reason")?("none"==e.$blockPopWinHtml.find(".b_reason_top").css("display")&&e.$blockPopWinHtml.find(".b_reason_top").css({display:"block"}),$(this).siblings(".b_reason_item").removeClass("b_reason_curr").end().addClass("b_reason_curr"),$(this).hasClass("b_add_new_reason")?(e.curr_pattern="add",e.$blockPopWinHtml.find(".b_textarea").trigger("focus")):(e.curr_pattern="modify",$.stats.track("reasonItem"+$(this).index(),"uegCount","bawuAppeal","click")),e.$blockPopWinHtml.find(".b_label_tips").hide(),e.setTextareaVal(),void e.toogleToolBar()):!1})},logicalControl:function(){var e=this,a=e.$blockPopWinHtml.find(".b_fixed_time"),t=e.$blockPopWinHtml.find(".b_select_time");if(e.$blockPopWinHtml.find(".b_reason_item").eq(0).addClass("b_reason_curr"),e.isManager){var i="\u63D0\u793A\uFF1A\u5927\u5427\u4E3B\u53EF\u7F16\u8F91\u539F\u56E0\u6A21\u7248\uFF0C\u4FDD\u5B58\u540E\u5C0F\u5427\u4E3B\u53EF\u76F4\u63A5\u4F7F\u7528\u6587\u6848~";e.forum.isPrivateForum&&(i="\u63D0\u793A\uFF1A\u5427\u4E3B\u53EF\u7F16\u8F91\u539F\u56E0\u6A21\u677F\uFF0C\u6A21\u677F\u4FDD\u5B58\u540E\u7BA1\u7406\u5427\u52A1\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u6A21\u677F\u7684\u6587\u6848~"),e.$blockPopWinHtml.find(".b_fixed_tips").html(i),e.user_num>1?(a.css({display:"block"}),t.css({display:"none"})):1==e.user_num&&(a.css({display:"none"}),t.css({display:"block"})),e.$blockPopWinHtml.find(".b_reason_top,.b_top_mod_bar").css({display:"block"}),e.modifyTextareaCon(),e.deleteTextareaCon(),e.saveTextareaCon(),e.cancelTextareaCon()}else{var n="\u63D0\u793A\uFF1A\u539F\u56E0\u6A21\u7248\u53EA\u6709\u5927\u5427\u4E3B\u53EF\u4EE5\u7F16\u8F91\uFF0C\u5C0F\u5427\u4E3B\u4E5F\u53EF\u76F4\u63A5\u5728\u8F93\u5165\u6846\u4E2D\u5199\u4E0A\u5185\u5BB9\u5E76\u5B8C\u6210\u5C01\u7981~";e.forum.isPrivateForum&&(n="\u63D0\u793A\uFF1A\u7BA1\u7406\u5427\u52A1\u53EF\u4EE5\u4F7F\u7528\u5427\u4E3B\u7F16\u8F91\u7684\u539F\u56E0\u6A21\u677F\uFF0C\u6216\u8005\u81EA\u5DF1\u5728\u8F93\u5165\u6846\u586B\u5199\u5185\u5BB9\u5B8C\u6210\u5C01\u7981~"),e.$blockPopWinHtml.find(".b_fixed_tips").html(n),a.css({display:"block"}),t.css({display:"none"})}}}});_.Module.define({path:"common/widget/ParamsXssHandler",requires:[],sub:{_escapeKeyArray:["title","prefix","kw","word"],initial:function(e){e&&e.escapeKeyArray&&e.escapeKeyArray.length>0&&(this._escapeKeyArray=e.escapeKeyArray)},xssFilter:function(e){var r=$.extend({},e),a=$.tb.escapeHTML,s=this._escapeKeyArray;return $.each(s,function(i){var t=s[i],n=e[t];void 0!==n&&(r[t]=a(n))}),r}}});_.Module.define({path:"common/widget/BskService",requires:[],sub:{initial:function(){this.loader=window._BSK?{done:function(n){n()},fail:function(){}}:$.ajax({url:"https://fex.bdstatic.com/bsk/??dknsaZmLdyKfEeIVbKxn_dcc70f7.js,omzVouOACqkNljzDbdOB_af501e9.js",cache:!0,dataType:"script"})},slientEncrypt:function(n,e){return this.encrypt(n,e)["catch"](function(){return e})},encrypt:function(n,e){var t=this;return new Promise(function(i,o){t.loader.done(function(){window._BSK||o(new Error("BSK load failed"));var t={};window._BSK.a("omzVouOACqkNljzDbdOB",{IN:n,OUT:t}),$.extend(e,{_BSK:t.data}),i(e)}).fail(function(){o(new Error("BSK load failed"))})})}}});var FORUM_POST_PREFIX="/f/commit/",FORUM_POST_URL={threadAdd:FORUM_POST_PREFIX+"thread/add",postAdd:FORUM_POST_PREFIX+"post/add",threadVoteAdd:FORUM_POST_PREFIX+"vote/add ",forumCreate:FORUM_POST_PREFIX+"forum/create",threadDelete:FORUM_POST_PREFIX+"thread/delete",postDelete:FORUM_POST_PREFIX+"post/delete",goodAdd:FORUM_POST_PREFIX+"thread/good/add",goodCancel:FORUM_POST_PREFIX+"thread/good/cancel",threadTopAdd:FORUM_POST_PREFIX+"thread/top/add",threadTopCancel:FORUM_POST_PREFIX+"thread/top/cancel",threadTopicAdd:"/zhibo/commit/add",threadTopicCancel:"/zhibo/commit/set",get_tbs:"/dc/common/tbs"},FORUM_ERROR_INFO={24:"\u767B\u5F55\u9519\u8BEF\uFF0C\u53EF\u80FD\u8F93\u5165\u7684\u7528\u6237\u540D\u548C\u53E3\u4EE4\u4E0D\u6B63\u786E\uFF0C\u8BF7\u5355\u51FB\u786E\u5B9A\u91CD\u8BD5",102:"\u6CE8\u518C\u7528\u6237email\u975E\u6CD5",103:"\u6CE8\u518C\u7528\u6237\u4E2A\u4EBA\u4FE1\u606F\u975E\u6CD5",107:"\u7528\u6237\u540D\u6216\u81EA\u6211\u4ECB\u7ECD\u7684\u6587\u5B57\u4E2D\u542B\u6709\u4E00\u4E9B\u4E0D\u6070\u5F53\u7684\u8BCD\u6C47\uFF0C\u8BF7\u60A8\u91CD\u65B0\u63D0\u4EA4\u6CE8\u518C\u4FE1\u606F",108:"\u7528\u6237\u540D\u4E3A\u7A7A",266:"\u6DFB\u52A0\u597D\u53CB\u91CD\u590D",205:"\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6B64\u4FEE\u6539\u6743\u9650\uFF0C\u8BF7\u5230\u60A8\u6CE8\u518C\u7684\u7CFB\u7EDF\u4E2D\u4FEE\u6539\u4FE1\u606F",305:"\u6DFB\u52A0\u8BCD\u8BED\u5230\u8FBE\u6700\u5927\u503C",306:"\u6DFB\u52A0\u8BCD\u8BED\u5230\u8FBE\u6700\u5927\u503C",309:"\u6DFB\u52A0\u8BCD\u8BED\u5230\u8FBE\u6700\u5927\u503C",260:"\u8BA8\u8BBA\u533A\u5DF2\u6EE1\u4E09\u4E2A\u5427\u4E3B",261:"\u8BE5\u7528\u6237\u5DF2\u7ECF\u662F\u8BE5\u5427\u7684\u5427\u4E3B",262:"\u8BE5\u7528\u6237\u5DF2\u7ECF\u662F\u4E09\u4E2A\u8D34\u5427\u7684\u5427\u4E3B",263:"\u7528\u6237\u6307\u5B9A\u597D\u53CB\u540D\u4E0D\u5B58\u5728",264:"\u7528\u6237\u597D\u53CB\u6570\u5230\u8FBE\u6700\u5927",265:"\u7528\u6237\u672A\u767B\u9646",267:"\u6DFB\u52A0\u6536\u85CF\u5939\u5230\u6700\u5927\u503C",300:"\u8FBE\u5230\u7CFB\u7EDF\u6700\u5927\u8FC7\u6EE4\u7528\u6237\u5BB9\u91CF",301:"\u8FBE\u5230\u7CFB\u7EDF\u6700\u5927\u8FC7\u6EE4IP\u5BB9\u91CF",302:"\u7BA1\u7406\u5458\u6307\u5B9A\u7684\u5173\u952E\u5B57\u4E0D\u5B58\u5728\u8D34\u5427",303:"\u7BA1\u7406\u5458\u6307\u5B9A\u7684\u7528\u6237\u540D\u4E0D\u5B58\u5728",304:"\u7BA1\u7406\u5458\u6307\u5B9A\u7684IP\u6709\u8BEF",316:"\u64CD\u4F5C\u5931\u8D25\uFF01\u8BE5IP\u5730\u5740\u4E3A\u624B\u673A\u4E0A\u7F51\u4F7F\u7528\uFF0C\u65E0\u6CD5\u76F4\u63A5\u5C01\u7981\u3002",401:"\u6839\u636Eforum_id \u4E0D\u80FD\u5F97\u5230\u8BA8\u8BBA\u540D",402:"\u5F97\u5230\u7684\u8D34\u5427\u540D\u592A\u957F",870:"\u697C\u9AD8\u4EBA\u591A\uFF0C\u8BF7\u52FF\u63A8\u5012",871:"\u697C\u9AD8\u614E\u63A8\uFF0C\u51B7\u9759\u4F1A\u513F\u5427",872:"\u7CBE\u54C1\u6765\u7684\u4E0D\u6613\uFF0C\u8BF7\u52FF\u64C5\u81EA\u5220\u9664",874:"\u5427\u520A\u6765\u5F97\u4E0D\u6613\uFF0C\u8BF7\u52FF\u64C5\u81EA\u5220\u9664"};
;var Thread_add_result={resultNo:0,fid:"",tid:"",vid:"",sign:"",bdauditreason:0,bdQueryWordEnc:"",autoMsg:"",is_login:0,init:function(e){if(Thread_add_result&&e.data&&"object"==typeof e.data)for(var a in e.data)Thread_add_result[a]=e.data[a];_.Module.use("ueglibs/widget/Ban",[],function(e){Thread_add_result.BanLib=e}),Thread_add_result.resultNo=e.no},isNeedWaitForCheck:function(){var e=!1;switch(this.resultNo){case 9:case 20:case 23:e=!0}return e},isNeedBindPhone:function(){return 4010==this.resultNo},Action_FocusTitle:"focusTitle",Action_FocusContent:"focusContent",Action_ClearYZM:"clearYZM",Action_FocusUrl:"focusUrl",Action_GoToHead:"goToHead",Action_FlushAndGoToHead:"flushAndGoToHead",getActionType:function(){var e="";switch(this.resultNo){case 10:case 14:case 501:case 15:case 36:case 41:case 42:case 43:case 46:case 9001:case 10010:case 10011:case 10012:case 10013:case 220012:case 220015:case 220035:case 2130001:case 2130007:case 2130008:case 2130009:case 2130011:case 2130012:case 2130014:case 2130005:e=this.Action_FocusContent;break;case 11:case 20:e=this.Action_FocusTitle;break;case 17:case 0:e=this.Action_FlushAndGoToHead;break;case 22:case 9:case 23:case 119:case 44:case 100:case 703:case 704:case 705:e=this.Action_GoToHead;break;case 38:case 39:case 40:e=this.Action_ClearYZM;break;case 1120:case 1121:e=this.Action_FocusUrl}return e},getMessage:function(){var e="",a=null;if(this.resultNo>=901&&this.resultNo<=950)return Thread_add_result.autoMsg;switch(null==a&&(a=PageData.forum?PageData.forum.id:null),null==a&&(a=PageData.forum_id),null==a&&(a=PageData.forumID),this.resultNo){case 10:e="\u8D34\u5B50\u5185\u5BB9\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57";break;case 11:e="\u8D34\u5B50\u6807\u9898\u548C\u5185\u5BB9\u592A\u957F";break;case 12:e=null!=a?this.BanLib.render("oldPosterDialog"):"\u64CD\u4F5C\u5931\u8D25";break;case 13:e=null!=a?"\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01<br/><a href='/upc/userinfo?fid="+a+'\' target="_blank">\u67E5\u770B\u5C01\u7981\u4FE1\u606F</a>':"\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01 ";break;case 14:e="\u60A8\u53D1\u5E03\u7684\u8D34\u5B50\u5DF2\u7ECF\u5B58\u5728";break;case 501:case 15:e="\u8BF7\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00<br>\u8BF7\u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34";break;case 16:e="\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6240\u8F93\u5165\u7684\u8D34\u5427\u4E0D\u5B58\u5728\u3002\u7531\u4E8E\u7CFB\u7EDF\u5347\u7EA7\u7EF4\u62A4\uFF0C\u65B0\u5EFA\u8D34\u5427\u529F\u80FD\u6682\u505C\uFF0C\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\uFF01";break;case 19:case 200:case 201:case 202:e="\u60A8\u7684\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u786E\u8BA4\u540E\u518D\u53D1\u8868";break;case 20:e="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u7684\u6807\u9898\u6216\u6B63\u6587\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u53D1\u8868";break;case 17:e="\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01";break;case 18:case 21:e="\u5176\u4ED6\u672A\u77E5\u539F\u56E0";break;case 22:e="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u7531\u4E8E\u7279\u6B8A\u539F\u56E0\u6211\u4EEC\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u6211\u4EEC\u4F1A\u572810\u5206\u949F\u5185\u786E\u8BA4\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85\uFF01";break;case 9:e=this.getCheckMessage(this.bdauditreason);break;case 33:e=1==Thread_add_result.is_login?"\u60A8\u53D1\u8D34\u592A\u5FEB\u4E86:) \u8BF7\u7A0D\u540E\u518D\u53D1":"\u60A8\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u7CFB\u7EDF\u5BF9\u533F\u540D\u53D1\u8D34\u8FDB\u884C\u4E25\u683C\u7684\u63A7\u5236\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD";break;case 34:e=1==Thread_add_result.is_login?"\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898":"\u60A8\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u7CFB\u7EDF\u5BF9\u533F\u540D\u53D1\u8D34\u8FDB\u884C\u4E25\u683C\u7684\u63A7\u5236\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD";break;case 220034:e="\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898";break;case 220035:e="\u4EB2\uFF0C\u5DF2@\u4E0D\u5C11\u4EBA\u4E86\uFF0C\u4EE5\u514D\u6253\u6405\u66F4\u591A\u4EBA\uFF0C\u6B47\u4E00\u4F1A\u5427~";break;case 35:e=1==Thread_add_result.is_login?"\u4EB2\uFF0C\u5DF2@\u4E0D\u5C11\u4EBA\u4E86\uFF0C\u4EE5\u514D\u6253\u6405\u66F4\u591A\u4EBA\uFF0C\u6B47\u4E00\u4F1A\u5427~":"\u60A8\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u7CFB\u7EDF\u5BF9\u533F\u540D\u53D1\u8D34\u8FDB\u884C\u4E25\u683C\u7684\u63A7\u5236\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD";break;case 36:e="\u8BF7\u4E0D\u8981\u53D1\u5E7F\u544A\u8D34\uFF01";break;case 37:e="\u60A8\u5DF2\u5C1D\u8BD5\u63D0\u4EA4\u591A\u6B21\u4E86\uFF0C\u8BF7\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34";break;case 38:e="\u9A8C\u8BC1\u7801\u8D85\u65F6\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165";break;case 39:e="\u7531\u4E8E\u60A8\u591A\u6B21\u8F93\u9519\u9A8C\u8BC1\u7801\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34";break;case 40:e="\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u91CD\u65B0\u8F93\u5165";break;case 41:e="\u60A8\u7684\u8D34\u5B50\u53EF\u80FD\u5305\u542B\u4E0D\u5408\u9002\u7684\u5185\u5BB9\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u63D0\u4EA4";break;case 42:e="\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u88AB\u7CFB\u7EDF\u8BA4\u4E3A\u6709\u53D1\u5E7F\u544A\u5ACC\u7591\uFF0C\u8BF7\u60A8\u7A0D\u540E\u518D\u53D1";break;case 43:e="\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u6216\u8D34\u5B50\u5185\u5BB9\u6709\u5E7F\u544A\u6216\u4E0D\u5408\u9002\u7684\u7279\u5F81\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u53D1\u9001";break;case 23:e="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u9700\u8981\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u5EFA\u7ACB\u8D34\u5427";break;case 119:e="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u4E3B\u9898\u7684\u56DE\u590D\u6570\u5DF2\u7ECF\u8FBE\u5230\u4E0A\u9650\uFF0C\u611F\u8C22\u60A8\u7684\u53C2\u4E0E\uFF0C\u6B22\u8FCE\u60A8\u6D4F\u89C8\u672C\u5427\u7684\u5176\u5B83\u4E3B\u9898";break;case 1120:e="\u62B1\u6B49\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u3001\u89C6\u9891\u94FE\u63A5\u5730\u5740\u9519\u8BEF\uFF0C\u60A8\u53EF\u4EE5\u70B9\u51FB<a href='//www.baidu.com/search/post_img.html' target='_blank'>\u67E5\u770B\u76F8\u5173\u5E2E\u52A9</a>\u6216\u8FD4\u56DE\u4FEE\u6539";break;case 1121:e="\u62B1\u6B49\uFF0C\u89C6\u9891\u670D\u52A1\u5347\u7EA7\u4E2D\uFF0C\u60A8\u6682\u65F6\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u89C6\u9891\u7684\u8D34\u5B50\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u8BF7\u539F\u8C05";break;case 44:e="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8868\u4E3B\u9898\u8D34\u5B50\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u6216\u56DE\u590D\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002";break;case 100:e="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u4F7F\u7528\u5B8C\u6574\u7684\u8D34\u5427\u529F\u80FD\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002";break;case 701:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u4E0D\u5141\u8BB8\u672A\u767B\u5F55\u7528\u6237\u53D1\u8D34\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 702:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 703:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u4F1A\u5458\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F\u3002<a href='/f?kw="+this.bdQueryWordEnc+"#1' target=_blank>\u70B9\u6B64\u7533\u8BF7\u52A0\u5165</a>\u672C\u5427\u4F1A\u5458";break;case 704:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u7BA1\u7406\u56E2\u961F\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 705:e="\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01";break;case 706:e="\u62B1\u6B49\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002";break;case 45:e="\u62B1\u6B49\uFF0C\u60A8\u63D0\u4EA4\u7684\u8D34\u5427\u540D\u79F0\u542B\u7279\u6B8A\u5B57\u7B26\uFF0C\u76EE\u524D\u65E0\u6CD5\u521B\u5EFA\uFF0C\u63A8\u8350\u60A8\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u6216\u6570\u5B57\u4F5C\u4E3A\u8D34\u5427\u540D\u79F0";break;case 46:e="\u62B1\u6B49\uFF0C\u60A8\u7684\u8D34\u5B50\u8FC7\u957F\uFF0C\u65E0\u6CD5\u6B63\u5E38\u63D0\u4EA4\u3002\u5EFA\u8BAE\u60A8\u7CBE\u7B80\u6216\u5206\u6BB5\u540E\u91CD\u65B0\u63D0\u4EA4\uFF0C\u8C22\u8C22!";break;case 800:break;case 801:break;case 802:break;case 803:break;case 804:break;case 805:break;case 806:break;case 807:break;case 808:break;case 809:break;case 814:break;case 815:e="\u62B1\u6B49\uFF0C\u60A8\u5DF2\u9000\u51FA\u767B\u5F55\u6216\u672A\u8D2D\u4E70\u97F3\u4E50\u9053\u5177\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5";break;case 900:e="\u4E3A\u62B5\u5FA1\u6316\u575F\u5371\u5BB3\uFF0C\u672C\u5427\u5427\u4E3B\u5DF2\u653E\u51FA\u8D34\u5427\u795E\u517D--\u8D85\u7EA7\u9759\u6B62\u86D9\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002";break;case 961:e="\u53D1\u8D34\u5931\u8D25\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u5730\u5740\u6709\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u66F4\u6B63\u540E\u518D\u6B21\u53D1\u5E03\uFF1A\uFF09";break;case 9001:e="\u7531\u4E8E\u533F\u540D\u72B6\u6001\u6216\u672C\u5427\u8BBE\u7F6E\uFF0C\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u56FE\u7247\u7684\u4E3B\u9898\u3002";break;case 2100:e="\u5185\u5BB9\u542B\u6709\u9AD8\u7EA7\u5B57\u4F53\u6548\u679C\uFF0C\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u5C31\u80FD\u4F7F\u7528\u54E6~~";break;case 4010:e="\u60A8\u7684\u8D26\u53F7\u5B58\u5728\u5B89\u5168\u98CE\u9669\u6682\u4E0D\u80FD\u53D1\u8D34\uFF0C\u8BF7\u5148\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u540E\u518D\u53D1\u8D34\u5427\u3002";break;case 9e3:e="\u60A8\u8FD8\u6CA1\u6709\u7528\u6237\u540D\uFF0C\u4E0D\u80FD\u5728\u672C\u5427\u53D1\u8D34\u3002\u8BF7\u5148\u586B\u5199\u7528\u6237\u540D\u3002";break;case 10010:e="\u60A8\u7684\u6027\u522B\u65E0\u6CD5\u8FDB\u884C\u59B9\u7EB8\u8BA4\u8BC1</br><a style = 'font-size:12px;' href = '/i/sys/jump?un="+encodeURIComponent(PageData.user.name)+"&type=profile#sexm' target ='_blank'>\u53BB\u4FEE\u6539\u6211\u7684\u6027\u522B>><a>";break;case 10012:e="\u8BF7\u4E0A\u4F20\u81F3\u5C11\u4E00\u5F20\u56FE\u7247\u3002";break;case 10013:e="\u60A8\u53D1\u5F80\u7684\u5427\u672A\u5F00\u901A\u59B9\u7EB8\u8BA4\u8BC1\u529F\u80FD\u3002";break;case 2130001:e="\u8BF7\u4E0D\u8981\u7ED9\u975E\u59B9\u7EB8\u7528\u6237\u6295\u7968\u3002";break;case 2130007:e="\u60A8\u7684\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\u3002";break;case 2130008:e="\u60A8\u5DF2\u7ECF\u7ED9\u8BE5\u7528\u6237\u6295\u8FC7\u7968\u3002";break;case 2130009:e="\u6295\u7968\u5931\u8D25\u3002";break;case 2130005:e="\u60A8\u5DF2\u7ECF\u53D1\u8D77\u8FC7\u59B9\u7EB8\u8BA4\u8BC1\u8D34</br><a href='/p/"+Thread_add_result.thread_id+"' target = '_blank' >//tieba.baidu.com/p/"+Thread_add_result.thread_id+"</a>";break;case 2130011:e="\u59B9\u7EB8\u8BA4\u8BC1\u7528\u6237\u4E4B\u95F4\u4E0D\u80FD\u76F8\u4E92\u6295\u7968\u3002";break;case 220012:e="\u60A8\u7684\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\u3002";break;case 220013:e="\u60A8\u7684IP\u5DF2\u88AB\u5C01\u7981\u3002";break;case 225001:e="\u60A8\u7684\u8D26\u53F7\u7981\u6B62\u8D34\u6761\u3002";break;case 220015:e="\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u542B\u6709\u654F\u611F\u4FE1\u606F\u3002";break;case 219e4:e="<p>\u62B1\u6B49\u60A8\u6CA1\u6709\u8D34\u6761\u9053\u5177\u4E86\u4E0D\u80FD\u53D1\u5E03\u8D34\u6761\u4FE1\u606F\u3002</p><p>PS\uFF1A\u53D1\u8D34,\u56DE\u8D34,\u53C2\u52A0\u6D3B\u52A8\u90FD\u6709\u673A\u4F1A\u83B7\u5F97\u8D34\u6761\u9053\u5177\u3002</p>";break;case 2130012:e="\u4E0D\u80FD\u7ED9\u81EA\u5DF1\u6295\u7968\u3002";break;case 2130014:e="\u4E0D\u80FD\u7ED9\u7537\u6027\u7528\u6237\u6295\u7968";break;case 2190001:e='<p style="margin-top:-8px">\u8D34\u6761\u6CA1\u6709\u53D1\u5E03\u6210\u529F\u8BF7\u7A0D\u540E\u5728\u8BD5\u3002</p><p>PS\uFF1A\u53D1\u5E03\u8D34\u6761\u670910\u79D2\u7684CD\u65F6\u95F4\u3002</p>';break;case 2190002:e="\u62B1\u6B49\uFF0C\u6BCF\u5C0F\u65F6\u53EA\u80FD\u62A2\u4E00\u6B21\u8D34\u6761\u3002";break;case 2190003:e="<p>\u771F\u9057\u61BE~\u60A8\u6CA1\u6709\u62A2\u5230\u8D34\u6761\u9053\u5177\u3002</p><p>PS\uFF1A\u7B49\u7EA7\u8D8A\u9AD8\u83B7\u5F97\u9053\u5177\u51E0\u7387\u8D8A\u9AD8\u54E6\uFF01</p>";break;case 2190004:e="\u670D\u52A1\u5668\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5";break;case 2190005:e="\u60A8\u7684\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\u3002";break;case 2190006:e="\u8D34\u6761\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\u3002";break;case 2190007:e="\u8D34\u6761\u5185\u5BB9\u8FC7\u957F\u3002";break;case 2190008:e="\u62B1\u6B49\uFF0C\u4E00\u5929\u6700\u591A\u53EA\u80FD\u83B7\u5F9710\u4E2A\u9053\u5177";break;default:e="\u672A\u77E5\u9519\u8BEF\u3002"}return e},getCheckMessage:function(e){var a="";switch(e){case-61:a="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u8D34\u5B50\u8D28\u91CF\uFF0C\u672C\u5427\u6240\u53D1\u7684\u8D34\u5B50\u5F85\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case-62:a="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u8D34\u5B50\u8D28\u91CF\uFF0C\u672C\u5427\u8D34\u56FE\u7684\u8D34\u5B50\u9700\u8981\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case-74:case-75:case-60:a="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case-70:a="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u63A7\u5236\u5E7F\u544A\u8D34\uFF0C\u9700\u8981\u901A\u8FC7\u5BA1\u6838\u540E\u624D\u80FD\u53D1\u5E03\u3002\u767B\u9646\u7F72\u540D\u53D1\u8D34\u4E0D\u53D7\u6B64\u9650\u5236\u3002";break;case-71:a="\u60A8\u53D1\u8868\u7684\u5E16\u5B50\u592A\u957F\u4E86\u3002\u4E3A\u4E86\u9632\u6B62\u704C\u6C34\uFF0C\u9700\u7CFB\u7EDF\u5BA1\u6838\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u7A0D\u540E\u67E5\u770B";break;default:a="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85"}return a}};
;var SignNameApply={fillPanelId:"signNamePanel",getUrl:"/f/user/sign_list?t="+(new Date).getTime().toString(36),isFirst:!0,isUsed:0,data:{},template:function(){var e='<div id="signNameWrapper">';if(e+='<input type="checkbox" id="useSignName" name="useSignName"><label for="useSignName">\u4F7F\u7528\u7B7E\u540D\u6863</label>&nbsp;',e+='<span id="signNameShow"'+(0==this.isUsed?'style="display:none;"':"")+">",this.data.signs.length>0){e+='<select id="sign_id" name="sign_id">';for(var s=0,i=this.data.signs.length;i>s;s++){var t=this.data.signs[s];e+='<option value="'+t.id+'"'+(t.id==this.data.used_id?"selected=selected":"")+">"+t.name+"</option>"}e+="</select>",e+='&nbsp;<a style="color:#0449BE" target="_blank" href="/i/sys/jump?type=signsetting">\u67E5\u770B\u5168\u90E8</a>'}else e+='\uFF08\u60A8\u76EE\u524D\u6CA1\u6709\u53EF\u4F7F\u7528\u7684\u7B7E\u540D\u6863\uFF0C&nbsp;<a style="color:#0449BE" target="_blank" href="/i/sys/jump?type=signsetting">\u67E5\u770B\u5168\u90E8</a>)';return e+="</span>",e+="</div>"},active:function(){if(this.isFirst){this.isFirst=!1;var e=this.getUrl;this.postProcess(e,null,this.build)}},postProcess:function(e,s,i){var t=this;null==s?$.get(e,function(e){var s=$.json.decode(e);0==s.no&&"function"==typeof i&&i(t,s)}):$.post(e,SignNameApply._convertToQueryString(s),function(e){var s=$.json.decode(e);0==s.no&&"function"==typeof i&&i(t,s)})},_convertToQueryString:function(e){var s=[];for(var i in e)s.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return s.join("&")},build:function(e,s){e.data=s.data,e.isUsed=s.data.need,e.fillToPage()},fillToPage:function(){$("#"+this.fillPanelId).html(this.template()),this.initPage()},showList:function(){1==this.isUsed?$("#signNameShow").css("display",""):$("#signNameShow").css("display","none")},initPage:function(){1==this.isUsed?$("#useSignName").tbattr("checked",!0):$("#useSignName").tbattr("checked",!1),this.showList(),this.handlerEven()},setisUsed:function(e){this.isUsed=e?1:0,this.showList(),this.postProcess("/f/user/cm/sign_setneed",{need:this.isUsed,tbs:PageData.tbs},null)},handlerEven:function(){var e=this;$("#useSignName").click(function(){e.setisUsed(this.checked)})}};
;var PostHandler={post:function(e,o,t){$.ajax({type:"post",async:!1,dataType:"json",url:e,data:o,success:function(e){t&&t(e)}})},execute:function(e,o,t){var a=FORUM_POST_URL[e],n=["threadDelete","postDelete","goodAdd","goodCancel","threadTopAdd","threadTopCancel"];if($.inArray(e,n)>-1){var d=_.Module;d.use("common/widget/detectManagerBlock",[],function(e){e.doOnNotBlocked(function(){PostHandler.post(a,o,t)})})}else PostHandler.post(a,o,t)}};
;if(!UTSTART)var UTSTART=(new Date).getTime();if(!MOUSEPWD_CLICK)var MOUSEPWD_CLICK=0;var MousePwd=function(){function t(t){if(!t)var t=window.event;var e=0,n=0;return t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft,n=t.clientY+document.body.scrollTop),[e,n]}function e(t){return t.offsetParent?t.offsetLeft+e(t.offsetParent):t.offsetLeft}function n(t){return t.offsetParent?t.offsetTop+n(t.offsetParent):t.offsetTop}function o(o){o.stopPropagation();var i=t(o),r=c[this.id];if(r)r.hover||(r.hover=!0,r.count++);else{var u=e(this),f=n(this),s=u+this.offsetWidth,a=f+this.offsetHeight;r=c[this.id]={hover:!0,count:1,left:u,top:f,right:s,buttom:a}}r["mouse"+r.count]||(r["mouse"+r.count]=[],r["time"+r.count]={start:(new Date).getTime()},c.ma.push(r["mouse"+r.count])),r["mouse"+r.count].push(i),p.push("1")}function i(e){e.stopPropagation();var n=t(e),o=c[this.className];if(o&&o.hover){if(n[0]&&n[0]>o.left&&n[0]<o.right&&n[1]&&n[1]>o.top&&n[1]<o.buttom)return;o["time"+o.count].end=(new Date).getTime(),o.hover=!1}p.push("0")}function r(){var t=c.ma.length;if(t>0){var e=c.ma[t-1];return e[e.length-1]}}function u(){var t="",e=p.length;return e>10&&(p=p.slice(e-10)),t=p.join(",")}function f(){if(m)return h;var t=[r(),u(),(new Date).getTime()-UTSTART,[screen.width,screen.height].join(",")].join("	");return h.c=s(t)+","+g+MOUSEPWD_CLICK,m=!0,h}function s(t){for(var e=[],n={},o=g%100,i=0,r=t.length;r>i;i++){var u=t.charCodeAt(i)^o;e.push(u),n[u]||(n[u]=[]),n[u].push(i)}return e}function a(t){this.elements=t,$.each(t,function(t,e){$("."+e.toString()).bind("mouseover",o),$("."+e.toString()).bind("mouseout",i),v[e.toString()]=t}),$("body").bind("click",function(){MOUSEPWD_CLICK=1})}var c={ea:[],ma:[]},h={},m=!1,g=(new Date).getTime(),v={},p=[];return{start:a,report:f,time:g}}();_.Module.define({path:"common/widget/PicPoster",requires:["common/widget/ParamsXssHandler","common/widget/BskService"],sub:{initial:function(t){this.paramsXssHandler=this.requireInstance("common/widget/ParamsXssHandler"),this.pOp=t.pOp,this.eOp=t.eOp;var e=this.pOp,i=(this.eOp,e.tpl?"string"==typeof e.tpl?e.tpl:e.tpl.html():this._tpl);this.j_postor="string"==typeof e._container?$("#"+e._container):e._container,this._dataPostor=$.extend({},e._dataPostor);var s=this.j_postor;s.html(i),this.j_ed_container=s.find(".j_ed_container"),this._enabled=!0,this._isPosting=!1,this.j_qp_error=s.find(".j_imgp_error"),this.j_btn_submit=s.find(".j_btn_submit"),this.j_btn_smile=s.find(".j_btn_smile"),this.j_bannedTip=s.find(".j_bannedTip"),this._statInit(e._login,e._canPost,e._noUn)},_tpl:['<div class="imgp_wrap">','<div class="imgp_editor_container j_ed_container" id="j_ed_container"></div>','<p class="imgp_error j_imgp_error"></p>','<div class="imgp_footer clearfix">','<div class="imgp_btn">','<span class="imgp_submit j_btn_submit">\u53D1\u8868</span>','<span class="imgp_smile j_btn_smile"></span>',"</div>","</div>",'<div class="imgp_bannedTip j_bannedTip"></div>',"</div>"].join(""),_statInit:function(t,e,i){var s=this.pOp;return t?t&&1==e&&i?(this._cannotPost(),void this._showBannedTip("noUn")):t&&1!=e?(this._cannotPost(),void this._showBannedTip("cannotPost")):s._reach_limit?(this._cannotPost(),void this._showBannedTip("cannotPost")):s._img_del?(this._cannotPost(),void this._showBannedTip("img_del")):s._is_block?(this._cannotPost(),void this._showBannedTip("isBlock")):void(t&&1==e&&!i&&(this._editorInit("enable"),this._postBtnInit("enable"))):(this._cannotPost(),void this._showBannedTip("cannotPost"))},_overFlow:function(){this._disableEditor()},_unoverFlow:function(){this._enableEditor()},_keyDown:function(t){var e=this;17==t.keyCode?this._ctrl_down=!0:13==t.keyCode&&this._ctrl_down&&(this._submit(),t.srcElement?t.srcElement.blur():t.target.blur()),t.altKey&&83==t.keyCode&&(t.preventDefault?t.preventDefault():t.returnValue=!1,setTimeout(function(){e._submit()},0))},_disableEditor:function(){var t=this;t._enabled=!1;var e=t.j_btn_submit;e.addClass("imgp_submit_disabled").removeClass("imgp_submit").html("")},_disableSmile:function(){var t=this;t._enabled=!1;var e=t.j_btn_smile,i=t.pOp;return i._needSmile?(e.removeClass("imgp_smile"),e.html(""),void e.addClass("imgp_smile_disabled")):void e.hide()},focusSelf:function(){if(this._editor){var t=this._editor;"ie"==$.getBrowser().name&&(t.savedRange=null),setTimeout(function(){t.focus()},50)}},_enableEditor:function(){var t=this;t._enabled=!0;var e=t.j_btn_submit;e.removeClass("imgp_submit_disabled"),e.addClass("imgp_submit"),e.html("\u53D1\u8868")},_keyUp:function(t){17==t.keyCode&&(this._ctrl_down=!1)},_cannotPost:function(){return"tpl"==this.pOp._cpStyle?void this._cpStyle():(this._editorInit("disable"),this._postBtnInit("disable"),void(this._enabled=!1))},_cpStyle:function(){var t=$('<div class="lzl_simple_wrapper" style="width: auto; height: 52px; position: static;"><p class="lzl_ban_info"></p></div>');this.j_postor.html(t),this.j_banInfo=this.j_postor.find(".lzl_ban_info")},_postBtnInit:function(t){switch(t){case"disable":this._disableEditor();break;case"enable":var e=this,i=e.j_btn_submit;i.hover(function(){$(this).addClass("imgp_submit_hover")},function(){$(this).removeClass("imgp_submit_hover")}),i.mousedown(function(){i.addClass("imgp_submit_active")}),i.mouseup(function(t){i.removeClass("imgp_submit_active"),e._editor.focus(),e._submit(),t.target.blur()})}},_editorInit:function(t){var e=this,i=e.eOp,s={initialFrameHeight:/%$/.test(i.height)?i.height:parseInt(i.height)||60,initialFrameWidth:/%$/.test(i.width)?i.width:parseInt(i.width)||211,maxHeight:parseInt(i.maxHeight)||60,maxWordNum:i.maxWordNum||140,focusChangeColor:0,toolbar:[],noToolbar:1,excludePlugins:["draft","at","tb_image","baiduinput","emotion_transform","setting"]};switch(t){case"enable":e._editor=UE.getEditor("j_ed_container",s),e._editor.ready(function(){e._editorEvent()});break;case"disable":}},_editorEvent:function(){var t=this._editor,e=(this.pOp,this);t.addListener("ready",function(){$.browser.version>7&&t.focus()}),t.addListener("overflow",function(){e._overFlow()}),t.addListener("unoverflow",function(){e._unoverFlow()}),e.j_ed_container.on("keydown",function(t){e._keyDown(t)}),e.j_ed_container.on("keyup",function(t){e._keyUp(t)})},_tip:["","\u53C2\u4E0E\u672C\u5427\u8BA8\u8BBA\uFF0C\u8BF7\u5148 ","\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u9650\u5427\u52A1\u56E2\u961F\u53CA\u6CE8\u518C\u6EE1\u4E00\u5B9A\u65F6\u95F4\u7684\u8001\u7528\u6237\u53D1\u8D34","\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u5141\u8BB8","\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u9650\u5427\u52A1\u56E2\u961F\u53D1\u8D34","\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34"],_showBannedTip:function(t){{var e="tpl"==this.pOp._cpStyle?"<span>":'<div class="editor_banned_tip_info"><span>',i=this.pOp,s=this,o=s.j_bannedTip;this._dataPostor}switch(t){case"isBlock":e+='\u62B1\u6B49\uFF0C\u4F60\u53EF\u80FD\u5B58\u5728\u8FDD\u89C4\u64CD\u4F5C\uFF0C\u5DF2\u88AB\u5C01\u7981\u3002\u8BF7<a href="//tieba.baidu.com/pmc/main">\u70B9\u51FB\u6B64\u5904</a>\u67E5\u770B\u8BE6\u7EC6\u4FE1\u606F\u3002';break;case"noUn":e+="\u60A8\u8FD8\u6CA1\u6709\u7528\u6237\u540D\uFF0C\u4E0D\u80FD\u56DE\u590D\u3002\u8BF7\u5148<a href=\"javascript:void(0)\"  onclick=\"TbCom.process('User','buildUnameFrame','\u586B\u5199\u7528\u6237\u540D',' ')\">\u586B\u5199\u7528\u6237\u540D</a>";break;case"reach_limit":e+="\u672C\u56FE\u7247\u56DE\u590D\u5DF2\u8FBE\u4E0A\u9650\uFF0C\u8BF7\u53C2\u4E0E\u5176\u4ED6\u56FE\u7247\u8BA8\u8BBA";break;case"img_del":e+="\u62B1\u6B49\uFF0C\u8BE5\u56FE\u7247\u5DF2\u88AB\u5220\u9664\uFF0C\u65E0\u6CD5\u56DE\u590D";break;case"cannotPost":e+=s._tip[i._forumType],e+="</span>",1==i._forumType?(e+="<span>",e+="<a href=\"#\" onclick=\"TbCom.process('User', 'buildLoginFrame', null,null,null,'lzl');return false;\">\u767B\u5F55</a>",e+="&nbsp;|&nbsp",e+="<a href=\"#\" onclick=\"TbCom.process('User', 'buildRegisterFrame', 'lzl');return false;\">\u6CE8\u518C</a>"):3==i._forumType&&(e+='<span><a href="//tieba.baidu.com/f/like/level?kw=d8" >4\u7EA7\u5934\u8854</a>\u4EE5\u4E0A\u4F1A\u5458\u53D1\u8D34\u3002')}return e+="tpl"==i._cpStyle?"</span>":"</span></div>","tpl"==i._cpStyle?void this.j_banInfo.html(e):(o.html(e),void o.show())},_getData:function(){var t=this,e=t._dataPostor;return e.content=t._getUbbContent(),e.new_vcode=1,e.tag=11,e=this.paramsXssHandler.xssFilter(e)},_getUbbContent:function(){return UE.utils.html2ubb(this._getHtml())},showAlert:function(t,e){var i="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/img/errorFace.gif",s=$.tb.alert(e?{iconSrc:i,showShadow:!1,showTitle:!1,message:t,width:"240px",buttons:[]}:{showShadow:!1,showTitle:!1,message:t,width:"240px",buttons:[]});if($(".tb_alert_message").css("text-align","center"),$(".dialogJ .tb_alert_wrapper .tb_alert_title img").css("margin-left","75px"),e)var o=setTimeout(function(){clearTimeout(o),s.close()},800);return s},_getHtml:function(){var t=this._editor.getContent();return t=t.replace(/<br[^>]*>/gi," ").replace(/[\u3000\s]+/g," ").replace(/&nbsp;/g," ")},_validate:function(){var t=this,e=this._editor,i=t.j_qp_error;return this._enabled?e.getContentLength()?3==PageData.power.reply_private_flag?(e.focus(),i.html("\u7531\u4E8E\u697C\u4E3B\u8BBE\u7F6E\u4E86\u8BC4\u8BBA\u6743\u9650\uFF0C\u4F60\u65E0\u6CD5\u8BC4\u8BBA\u6B64\u8D34\u54E6").show(),!1):2==PageData.power.reply_private_flag?($.tb.alert({showShadow:!1,showTitle:!1,width:"300px",message:"\u7531\u4E8E\u697C\u4E3B\u7684\u8BBE\u7F6E\uFF0C\u4F60\u9700\u8981\u5173\u6CE8TA\u624D\u80FD\u53D1\u8868\u8BC4\u8BBA",buttons:[{text:"\u5173\u6CE8\u5E76\u53D1\u8868",callback:function(){var e=PageData.usr_name,i=PageData.tbs;$.tb.post("/home/post/follow",{un:e,tbs:i},function(e){if(e)if(0==e.no)var i=t.showAlert("\u5173\u6CE8\u6210\u529F",!1),s=setTimeout(function(){clearTimeout(s),i.close(),PageData.power.reply_private_flag=1,t._submit()},500);else 1130036==e.no?t.showAlert("\u8BE5\u7528\u6237\u4E0D\u5E0C\u671B\u88AB\u4ED6\u4EBA\u5173\u6CE8",!0):2260001==e.no?t.showAlert("\u64CD\u4F5C\u592A\u9891\u7E41\uFF0C\u8BF7\u6B47\u6B47\uFF01",!0):t.showAlert("\u5173\u6CE8\u5931\u8D25",!0);else t.showAlert("\u5173\u6CE8\u5931\u8D25",!0)})},"class":"guanzhu"},{text:"\u53D6\u6D88","class":"cancle"}]}),$(".tb_alert_message").css("text-align","center"),!1):!0:(e.focus(),i.html("\u53D1\u8D34\u5185\u5BB9\u9700\u5305\u542B\u6587\u5B57").show(),!1):!1},_submit:function(){if(this.trigger("onsubmit"),this._validate()&&!this._isPosting){this._isPosting=!0,this.j_qp_error.hide(),this._disableEditor();var t=this,e=t._getData();this.bskService=this.requireInstance("common/widget/BskService"),this.bskService.slientEncrypt({tbs:e.tbs},e).then(function(e){$.tb.post(t.pOp._submitUrl,e,function(e){return 0===e.no?(t.trigger("onsuccess"),t._editor.setContent(""),t._enableEditor()):(t._showAddResult(e),t._enableEditor()),t._isPosting=!1,!1})})}},showPostor:function(){this.j_postor.show()},hidePostor:function(){this.j_postor.hide()},setDataPostor:function(t){var e=this;t&&(e._dataPostor=$.extend(!0,e._dataPostor,t))},setSubmitUrl:function(t){this.pOp._submitUrl=t},removeDataPostor:function(t){var e=this;e._dataPostor[t]&&delete e._dataPostor[t]},_showErrorTip:function(t,e){var i='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: "\u5B8B\u4F53";"><table style="width:90%"><tbody><tr><td width="60">'+t.image+'</td><td valign="middle" style="font-size:20px;line-height:22px;font-family: "\u9ED1\u4F53";">'+t.subMessage+"</td></tr></tbody></table>"+t.message+"</div>",s=$.dialog.alert(i,t.dialogSet);s.bind("onclose",e)},_errorTipShow:function(t){var e=this;e.j_qp_error.html(t).show(),e.j_qp_error.focus()},_errorConfig:{},setErrorConfig:function(t){var e=arguments.length;if(e>1)return void(this._errorConfig[arguments[0]]=arguments[1]);var i=$.type(t);"object"==i&&(this._errorConfig=$.extend(!0,this._errorConfig,t))},deleteErrorConfig:function(t){delete this._errorConfig[t]},_errorConfigHandler:function(t){var e=this._errorConfig;for(var i in e)if(i==t){var s=e[i].message,o=e[i].callback;if(o)o(s);else if("dialog"==e[i].type){var n={image:'<img style="border:none;" src="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/img/errorFace.gif">',subMessage:"\u53D1\u8D34\u5931\u8D25",message:s,dialogSet:{width:410,height:95,title:"\u53D1\u8868\u8D34\u5B50"}};this._showErrorTip(n,function(){return self._editor.focus(),!0})}else this._errorTipShow(s);return!0}return!1},_showAddResult:function(t){var e=this;if(Thread_add_result.init(t),0!=t.no)if(Thread_add_result.isNeedWaitForCheck()){var i=Thread_add_result.getMessage(),s={image:'<img style="border:none;" src="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/img/messageFace.gif">',subMessage:"\u7B49\u5F85\u5BA1\u6838...",message:i,dialogSet:{width:380,height:105,title:"\u53D1\u8868\u8D34\u5B50"}};e._showErrorTip(s,function(){return e._editor.setContent(""),e._editor.focus(),!0})}else{if(e._errorConfigHandler(t.no))return;if(40==t.no)_.Module.use("common/component/CaptchaDialog",{message:t.data.vcode.str_reason,vCode:t.data.vcode.captcha_vcode_str,vCodeType:t.data.vcode.captcha_code_type,forumName:this._dataPostor.kw,forumId:this._dataPostor.fid,isAnonymous:0,postType:"reply",paramsCallback:function(){var t=e._getData(),i={content:t.content,title:t.title};return i.tid=e._dataPostor.tid,i}},function(t){e.captchaDialog=t,e._isPosting=!1,t.bind("onclose",function(){return e._isPosting=!1,t.hide(),!1}),t.bind("onaccept",function(){e.removeDataPostor("vcode"),e.removeDataPostor("vcode_md5"),e.setDataPostor({vcode:t.getInputValue(),vcode_md5:t.getVCode()}),e._submit(),e.removeDataPostor("vcode"),e.removeDataPostor("vcode_md5")}),t.show()});else if(4010==t.no){var o=$.dialog.alert("<div style='margin: 15px;'>"+Thread_add_result.getMessage()+"</div>",{title:"\u53D1\u8D34\u5931\u8D25",acceptValue:"\u7ED1\u5B9A\u624B\u673A",width:410,onaccept:function(){return $.tb.location.setHref("//passport.baidu.com/v2/?accountbindphone&tpl=tb&u="+encodeURIComponent($.tb.unescapeHTML($.tb.location.getHref()))),!1}});o.bind("onclose",function(){return e._editor.focus(),!0})}else{var i=Thread_add_result.getMessage(),s={image:'<img style="border:none;" src="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/img/errorFace.gif">',subMessage:"\u53D1\u8D34\u5931\u8D25",message:i,dialogSet:{width:410,height:95,title:"\u53D1\u8868\u8D34\u5B50"}};e._showErrorTip(s,function(){return e._editor.focus(),!0})}}}}});_.Module.define({path:"common/widget/ImageViewer/DataInterface",requires:["common/widget/ImageViewer/Hint"],sub:{_hint:null,_recRequest:null,guide:{pic_amount:0,pic_list:[]},albumData:{comment_amount:"",comment_type:1,create_type:"",create_time:"",creator:"",see_lz:"1",from_page:0,pic_amount:"",post_id:"",power:{},thread_id:"",thread_type:"",title:"",total_page:"0",user_list:{},desc:"",pic_id:"",img:{},power:{}},pageData:{forum_name:"",forum_name_u:"",forum_id:"",tid:"",pic_id:"",tbs:""},_urls:{guide:"/photo/bw/picture/guide",commentList:"/photo/bw/comment/list",albumRecommend:"/photo/bw/photo/albumrecommend/",setCover:"/photo/cm/album/editmx?kw="+encodeURIComponent(PageData.forum_name)+"&tbs="+Tbs.common,deletePhoto:{CM_THREAD_DEL:"/f/commit/thread/delete",CM_POST_DEL:"/f/commit/post/delete",CM_PICTURE_DEL:"/photo/cm/picture/del?kw="+encodeURIComponent(PageData.forum_name)+"&tbs="+Tbs.common}},_error_list:{12:"\u60A8\u7684id\u5DF2\u88AB\u5C01\u7981\uFF0C\u6682\u65E0\u6743\u9650\u8FDB\u884C\u6B64\u7C7B\u64CD\u4F5C\u3002",13:"\u60A8\u7684ip\u5DF2\u88AB\u5C01\u7981\uFF0C\u6682\u65E0\u6743\u9650\u8FDB\u884C\u6B64\u7C7B\u64CD\u4F5C\u3002",265:"\u60A8\u8FD8\u672A\u767B\u5F55\uFF0C\u8BF7\u767B\u5F55\u540E\u518D\u64CD\u4F5C",871:"\u60A8\u64CD\u4F5C\u592A\u9891\u7E41\u4E86\uFF0C\u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\uFF0C\u7A0D\u540E\u518D\u64CD\u4F5C\u5427:)",4001:"\u62B1\u6B49\uFF0C\u7531\u4E8E\u7CFB\u7EDF\u9519\u8BEF\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u91CD\u8BD5\u3002",4003:"\u60A8\u6CA1\u6709\u6743\u9650\u8FDB\u884C\u6B64\u7C7B\u64CD\u4F5C\u3002",4005:"\u60A8\u7684id\u5DF2\u88AB\u5C01\u7981\uFF0C\u6682\u65E0\u6743\u9650\u8FDB\u884C\u6B64\u7C7B\u64CD\u4F5C\u3002",4006:"\u60A8\u7684ip\u5DF2\u88AB\u5C01\u7981\uFF0C\u6682\u65E0\u6743\u9650\u8FDB\u884C\u6B64\u7C7B\u64CD\u4F5C\u3002",4008:"\u62B1\u6B49\uFF0C\u8BE5\u8D34\u5427\u4E0D\u5B58\u5728\u3002",4444:"\u8BE5\u56FE\u518C\u4E0D\u5B58\u5728\u3002",4010:"\u60A8\u7684\u8D26\u53F7\u5B58\u5728\u5B89\u5168\u98CE\u9669\u6682\u4E0D\u80FD\u53D1\u8D34\uFF0C\u8BF7\u5148\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u540E\u518D\u53D1\u8D34\u5427\u3002",4011:"\u60A8\u6CA1\u6709\u6743\u9650\u8FDB\u884C\u6B64\u7C7B\u64CD\u4F5C\u3002",4012:"\u62B1\u6B49\uFF0C\u56FE\u7247\u8BFB\u53D6\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u518D\u8BD5\u3002",4014:"\u5206\u7C7B\u540D\u79F0\u4E0D\u5F97\u91CD\u590D",4015:"\u63D0\u4EA4\u5931\u8D25\uFF1A\u672C\u5427\u5206\u7C7B\u6570\u5DF2\u8FBE\u5230\u4E0A\u9650\u3002",4016:"\u63D0\u4EA4\u5931\u8D25\uFF1A\u8BF7\u4E0D\u8981\u63D0\u4EA4\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u6216\u5E7F\u544A\u7684\u5185\u5BB9\u3002",4018:"\u62B1\u6B49\uFF0C\u672C\u5427\u56FE\u7247\u533A\u6682\u4E0D\u5F00\u653E\u3002",4019:"\u62B1\u6B49\uFF0C\u672C\u5427\u56FE\u7247\u533A\u6682\u4E0D\u5F00\u653E\u3002",4020:"\u62B1\u6B49\uFF0C\u672C\u5427\u56FE\u518C\u8FBE\u5230\u4E0A\u9650\u3002",4021:"\u56FE\u518C\u540D\u79F0\u4E0D\u5F97\u91CD\u590D",4022:"\u8BE5\u56FE\u518C\u5DF2\u88AB\u7F6E\u9876\uFF0C\u8BF7\u53D6\u6D88\u7F6E\u9876\u540E\u518D\u5220\u9664\u3002",4023:"\u8BE5\u56FE\u518C\u5DF2\u88AB\u52A0\u7CBE\uFF0C\u8BF7\u53D6\u6D88\u52A0\u7CBE\u540E\u518D\u5220\u9664\u3002",4024:"\u5F88\u62B1\u6B49\uFF0C\u8BE5\u56FE\u7247\u6240\u5728\u8D34\u5B50\u5DF2\u88AB\u5220\u9664\uFF0C\u8BF7\u5237\u65B0\u6216\u67E5\u770B\u5176\u5B83\u56FE\u7247\u3002",4033:"\u4E0E\u672C\u5427\u8D34\u5B50\u91CD\u540D\uFF0C\u8BF7\u4FEE\u6539\u56FE\u518C\u6807\u9898\u3002 ",4012:"\u62B1\u6B49\uFF0C\u56FE\u7247\u8BFB\u53D6\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u518D\u8BD5\u3002",4037:"\u62B1\u6B49\uFF0C\u672C\u56FE\u518C\u56FE\u7247\u5DF2\u8FBE\u5230\u4E0A\u9650\u3002",4038:"\u5F88\u62B1\u6B49\uFF0C\u8BE5\u56FE\u7247\u6240\u5728\u4E3B\u9898\u5DF2\u88AB\u5220\u9664\u3002",4039:"\u672C\u56FE\u7247\u56DE\u590D\u5DF2\u8FBE\u4E0A\u9650\uFF0C\u8BF7\u53C2\u4E0E\u5176\u4ED6\u56FE\u7247\u8BA8\u8BBA",4040:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u6587\u5B57\u4E0D\u80FD\u8D85\u8FC7140\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",4041:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u8F93\u5165\u7684\u8868\u60C5\u4E0D\u80FD\u8D85\u8FC710\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",4032:"\u4EC5\u9650\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF",4043:"\u63D0\u4EA4\u5931\u8D25\uFF1A\u8BF7\u5148\u586B\u5199\u7528\u6237\u540D",4044:"\u60A8\u9009\u62E9\u7684\u56FE\u518C\u4E0D\u5B58\u5728\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9\u5176\u4ED6\u56FE\u518C",4046:"\u4EC5\u9650\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF",4052:"\u76EE\u5F55\u540D\u79F0\u6700\u591A\u8F93\u51656\u4E2A\u6C49\u5B57",4058:"\u76EE\u5F55\u4E0D\u5B58\u5728\uFF0C\u8BF7\u5C1D\u8BD5\u5176\u5B83\u76EE\u5F55",10:"\u8D34\u5B50\u5185\u5BB9\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57",11:"\u8D34\u5B50\u6807\u9898\u548C\u5185\u5BB9\u592A\u957F",14:"\u4E0A\u4F20\u7684\u56FE\u7247\u5DF2\u7ECF\u5B58\u5728",501:"\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00 \u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34",15:"\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00 \u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34",16:"\u6240\u8F93\u5165\u7684\u8D34\u5427\u4E0D\u5B58\u5728\u3002\u7531\u4E8E\u7CFB\u7EDF\u5347\u7EA7\u7EF4\u62A4\uFF0C\u65B0\u5EFA\u8D34\u5427\u529F\u80FD\u6682\u505C\uFF0C\u5E0C\u671B\u5F97\u5230\u8C05\u89E3\uFF01",19:"\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u786E\u8BA4\u540E\u518D\u53D1\u8868",200:"\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u786E\u8BA4\u540E\u518D\u53D1\u8868",201:"\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u786E\u8BA4\u540E\u518D\u53D1\u8868",202:"\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u786E\u8BA4\u540E\u518D\u53D1\u8868",20:"\u53D1\u8868\u7684\u8D34\u5B50\u7684\u6807\u9898\u6216\u6B63\u6587\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57\uFF0C\u4FEE\u6539\u540E\u518D\u53D1\u8868",17:"\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u4E0A\u4F20\u56FE\u7247\uFF01",18:"\u5176\u4ED6\u672A\u77E5\u539F\u56E0",21:"\u5176\u4ED6\u672A\u77E5\u539F\u56E0",22:"\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u7531\u4E8E\u7279\u6B8A\u539F\u56E0\u6211\u4EEC\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\u3002",33:"\u64CD\u4F5C\u592A\u9891\u7E41\uFF0C\u8BF7\u4F11\u606F\u4E00\u4E0B\u518D\u6765\uFF01",34:"\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002",35:"\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002",36:"\u4E0D\u8981\u53D1\u5E7F\u544A\u8D34\uFF01",37:"\u5DF2\u5C1D\u8BD5\u63D0\u4EA4\u591A\u6B21\u4E86\uFF0C\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u4E0A\u4F20",38:"\u9A8C\u8BC1\u7801\u8D85\u65F6\uFF0C\u91CD\u65B0\u8F93\u5165",39:"\u7531\u4E8E\u591A\u6B21\u8F93\u9519\u9A8C\u8BC1\u7801\uFF0C\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u4E0A\u4F20",40:"\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8FD4\u56DE\u540E\u91CD\u65B0\u8F93\u5165",41:"\u8D34\u5B50\u53EF\u80FD\u5305\u542B\u4E0D\u5408\u9002\u7684\u5185\u5BB9\uFF0C\u786E\u5B9A\u540E\u518D\u63D0\u4EA4",42:"\u53D1\u8D34\u884C\u4E3A\u88AB\u7CFB\u7EDF\u8BA4\u4E3A\u6709\u53D1\u5E7F\u544A\u5ACC\u7591\uFF0C\u7A0D\u540E\u518D\u53D1",43:"\u53D1\u8D34\u884C\u4E3A\u6216\u8D34\u5B50\u5185\u5BB9\u6709\u5E7F\u544A\u6216\u4E0D\u5408\u9002\u7684\u7279\u5F81\uFF0C\u786E\u5B9A\u540E\u518D\u53D1\u9001",23:"\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u9700\u8981\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u5EFA\u7ACB\u8D34\u5427",119:"\u672C\u4E3B\u9898\u7684\u56DE\u590D\u6570\u5DF2\u7ECF\u8FBE\u5230\u4E0A\u9650\uFF0C\u611F\u8C22\u53C2\u4E0E\uFF0C\u6B22\u8FCE\u6D4F\u89C8\u672C\u5427\u7684\u5176\u5B83\u4E3B\u9898",1120:"\u8F93\u5165\u7684\u56FE\u7247\u3001\u89C6\u9891\u94FE\u63A5\u5730\u5740\u9519\u8BEF",1121:"\u89C6\u9891\u670D\u52A1\u5347\u7EA7\u4E2D\uFF0C\u6682\u65F6\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u89C6\u9891\u7684\u8D34\u5B50",44:"\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u521B\u5EFA\u56FE\u518C\uFF0C\u53EF\u4EE5\u6D4F\u89C8\u6216\u56DE\u590D\u672C\u5427\u5176\u5B83\u5185\u5BB9\u3002",100:"\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u4F7F\u7528\u5B8C\u6574\u7684\u8D34\u5427\u529F\u80FD\uFF0C\u53EF\u4EE5\u6D4F\u89C8\u672C\u5427\u5176\u5B83\u5185\u5BB9\u3002",701:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u4E0D\u5141\u8BB8\u672A\u767B\u5F55\u7528\u6237\u53D1\u8D34\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD",702:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8D34",703:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u4F1A\u5458\u624D\u80FD\u53D1\u8D34\u3002",704:"\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u7BA1\u7406\u56E2\u961F\u624D\u80FD\u4E0A\u4F20\u56FE\u7247\u3002",705:"\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u4E0A\u4F20\u56FE\u7247\uFF01",706:"\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002",45:"\u63D0\u4EA4\u7684\u8D34\u5427\u540D\u79F0\u542B\u7279\u6B8A\u5B57\u7B26 ",46:"\u8D34\u5B50\u8FC7\u957F\uFF0C\u65E0\u6CD5\u6B63\u5E38\u63D0\u4EA4\u3002",900:"\u5F00\u542F\u9759\u6B62\u86D9\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002"},_getGuideAmount:15,_guideRange:[],_requestGuideRange:[],_guideIsRequesting:!1,_guideIsReady:!1,_commentsRequest:null,_lastFetch:{},initial:function(){this._hint=this.getInstance("common/widget/ImageViewer/Hint")},_getErrorMsg:function(e){return this._error_list[String(e)]||"\u62B1\u6B49\uFF0C\u7531\u4E8E\u7CFB\u7EDF\u9519\u8BEF\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\u3002"},_requestGuideSample:function(e){var t,i,a,n,o=this.guide.pic_list,r=this;r._requestGuideRange[1]>r._guideRange[1]?(t=r._guideRange[1],i=o[t].img.original.id,a=r._getGuideAmount,n=0,r._requestGuide(i,n,a,e)):r._requestGuideRange[0]<r._guideRange[0]?(t=r._guideRange[0],i=o[t].img.original.id,a=0,n=r._getGuideAmount,r._requestGuide(i,n,a,e)):(this._guideIsRequesting=!1,"function"==typeof e&&e(r.guide))},_requestGuide:function(e,t,i,a){this._lastFetch={prev:t,next:i,pic_id:e};var n=this;$.tb.get(this._urls.guide,{kw:this.pageData.forum.name_url,tid:this.pageData.tid,see_lz:this.albumData.see_lz,from_page:this.albumData.from_page,alt:"jview",next:i,prev:t,pic_id:e},function(e){if(e.no&&0!=e.no)n._sendErrorRequest("fid="+n.pageData.forum_id+"&funcname=_requestGuide&errorNo="+e.no+"&errorType=guide_data_error"),n._hint.show(n._getErrorMsg(e.no));else{var t=n._lastFetch,i="fr=tb0_forum&st_mod=album_new&st_page=viewfloat";0!=n.guide.pic_amount&&e.data.pic_amount!=n.guide.pic_amount&&(n._sendErrorRequest("fid="+n.pageData.forum_id+"&funcname=_requestGuide&errorType=pic_num_unmatch"),$.stats.sendRequest(i+"&st_type=unmatched_pic_amount&old_amount="+this._originalPicAmount+"&new_amount="+e.pic_amount)),e.data.pic_list&&e.data.pic_list!={}||(n._sendErrorRequest("fid="+n.pageData.forum_id+"&funcname=_requestGuide&errorType=empty_pic_list"),$.stats.sendRequest(i+"&st_type=empty_pic_list&tid="+n.pageData.tid+"&pic_id="+t.pic_id+"&prev="+t.prev+"&next="+t.next)),n.guide.pic_amount=e.data.pic_amount;var o=e.data.pic_list;if("object"==typeof o){for(var r in o){var s=r.replace(/^#/,"")-1,u=o[r].img.original.host?location.protocol+"//"+o[r].img.original.host+"/":"https://imgsa.baidu.com/";o[r].img.original.url=u+"forum/pic/item/"+o[r].img.original.id+".jpg",n.guide.pic_list[s]=o[r],n.trigger("guide_complete_"+s,o[r])}n._makeGuideRange()}n._requestGuideSample(a)}})},_makeGuideRange:function(){var e=this.guide.pic_list;this._guideRange[1]=e.length-1;for(var t=0,i=e.length;i>t;t++)if("undefined"!=typeof e[t]){this._guideRange[0]=t;break}0==this._requestGuideRange.length&&(this._requestGuideRange[0]=this._guideRange[0],this._requestGuideRange[1]=this._guideRange[1])},_sendErrorRequest:function(e){var t=new Image;e+="&pageurl="+encodeURIComponent(location.href),PageData&&PageData.user&&(e+="&uid="+PageData.user.id),t.src="/photo/error?alt=json&"+e+"&t="+(new Date).getTime()},_getCreateType:function(e){return["\u901A\u8FC7\u672C\u5730\u4E0A\u4F20","\u901A\u8FC7URL\u4E0A\u4F20",'\u901A\u8FC7&nbsp;&nbsp;<a class="create_by_tools" href="http://xiangce.baidu.com" target="_blank">\u767E\u5EA6\u76F8\u518C</a>&nbsp;&nbsp;\u4E0A\u4F20;','\u901A\u8FC7&nbsp;&nbsp;<a class="create_by_tools" href="/tb/picture/shenqi.html" target="_blank">\u8D34\u56FE\u795E\u5668</a>&nbsp;&nbsp;\u4E0A\u4F20',"&nbsp;&nbsp;"][parseInt(e)]},_parseCommentsData:function(e){var t=e.user_list;if(e.creator&&t.hasOwnProperty(e.creator)){var i=t[e.creator];e.creator=i,e.creator_name=i.name,e.user_link=i.portrait?"/home/main?id="+i.portrait:"/home/main?un="+i.name}if(e.create_time&&(e.create_time=$.dateFormat(new Date(1e3*e.create_time),"M-d")),e.hasOwnProperty("create_type")&&(e.create_type=this._getCreateType(e.create_type)),$.isArray(e.comment_list))for(var a,n=e.comment_list,o="",r=0,s=n.length;s>r;r++)n[r].time=$.dateFormat(new Date(1e3*n[r].time),"yyyy-MM-dd HH:mm"),o=t[n[r].user_id],n[r].is_anonymous?n[r].itieba_link='<span target="_blank" class="af_reply_li_main_misc_user" >'+n[r].user_name+"</span>&nbsp;":(a=o.portrait?"/home/main?id="+o.portrait:"/home/main?un="+o.name,n[r].itieba_link='<a href="'+a+'" target="_blank" class="af_reply_li_main_misc_user" >'+n[r].user_name+"</a>&nbsp;"),o&&o.is_verify&&(n[r].user_name=o.nickname);return $.extend(this.data,e),e},init:function(e,t){var i=this;$.extend(this.pageData,e),$.extend(this.albumData,t),this.albumData.img.original.url="https://imgsa.baidu.com/forum/pic/item/"+this.albumData.img.original.id+".jpg",this._requestGuide(this.albumData.pic_id,this._getGuideAmount,this._getGuideAmount,function(e){0!=e.no?(i._guideIsReady=!0,i.trigger("guide_ready")):alert("guide\u8BF7\u6C42\u5931\u8D25")})},getGuideList:function(e,t){var i=this.guide.pic_amount,a=this._getGuideAmount,n=this._requestGuideRange,o=this._guideRange,r=this;return this._guideIsReady?void("next"==t&&e+a<=o[1]||"prev"==t&&e-a>=o[0]||"next"==t&&e+a<=n[1]||"prev"==t&&e-a>=n[0]||("next"==t?n[1]=Math.min(n[1]+a,i-1):"prev"==t&&(n[0]=Math.max(n[0]-a,0)),this._guideIsRequesting||(this._guideIsRequesting=!0,this._requestGuideSample()))):void this.bind("guide_ready",function(){r.getGuideList(e,t)})},getImageGuideByIndex:function(e,t){var i=this.guide.pic_list[e];return t&&"function"==typeof t?void(i?"function"==typeof t&&t(i):this.bind("guide_complete_"+e,function(e,i){"function"==typeof t&&t(i)})):i||null},getAlbumRecommend:function(e){var t=this;t.abortAlbumRecommendRequest(),t._recRequest=$.get(t._urls.albumRecommend,{kw:t.pageData.forum.name_url,alb_id:t.pageData.album_id,_t:(new Date).getTime()},function(t){var i=$.json.decode(t),a=i.data,n={url:"",title:"",tid:0,picList:[]};0==i.no&&a.thread_list&&a.thread_list.length>0&&(n.url="//tieba.baidu.com/photo/p?kw="+PageData.forum.name_url+"&from=6&tid="+a.thread_list[0].tid,n.tid=a.thread_list[0].tid,n.title=a.thread_list[0].title,n.picList=a.album_next_pic),e(n)})},abortAlbumRecommendRequest:function(){var e=this;e._recRequest&&(e._recRequest.abort(),e._recRequest=null)},getIndexByPicId:function(e){for(var t=this.guide.pic_list,i=0,a=t.length;a>i;i++)if(t[i]&&e==t[i].img.original.id)return i;return!1},getPicIdByIndex:function(e){var t=this.guide.pic_list;return t[e].img.original.id},getCommentList:function(e,t,i,a){var n=this;if(this._commentsRequest&&this._commentsRequest.abort(),a&&"function"==typeof i&&n.albumData.comment_list){var o={data:{}};return $.extend(o.data,n.albumData),n._parseCommentsData(o.data),void i(o,e)}this.getImageGuideByIndex(e,function(a){var o=a.img.medium.id;n._commentsRequest=$.get(n._urls.commentList,{alt:"jview",kw:n.pageData.forum.name_url,oc:0,pic_id:o,pn:t,rn:10,see_lz:n.albumData.see_lz,from_page:n.albumData.from_page,tid:n.pageData.tid},function(t){var a=$.json.decode(t);a.no&&0!=a.no?(n._hint.show(n._getErrorMsg(a.no)),4024==a.no?(n._sendErrorRequest("fid="+n.pageData.forum_id+"&funcname=getCommentList&errorNo=4024&errorType=nopic"),a.data.pic_amount<=1&&$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_type=error_type&st_value=4024")):4038==a.no?(n._sendErrorRequest("fid="+n.pageData.forum_id+"&funcname=getCommentList&errorNo=4038&errorType=albumisnotexist"),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_type=error_type&st_value=4038")):4001==a.no&&(n._sendErrorRequest("fid="+n.pageData.forum_id+"&funcname=getCommentList&errorNo=4001&errorType=systemerror"),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_type=error_type&st_value=4001"))):($.extend(n.albumData,a.data),n._parseCommentsData(a.data),"function"==typeof i&&i(a,e))})})},deletePhoto:function(e,t){var i=this,a={kw:this.pageData.forum.name_url,fid:this.pageData.forum_id,tid:this.pageData.tid,tbs:this.pageData.tbs},n="",o=this.albumData.comment_type;switch(a=t?$.extend(a,t):a,parseInt(o)){case 0:n=this._urls.deletePhoto.CM_THREAD_DEL;break;case 1:a.is_finf=0,a.pid=this.albumData.post_id,n=this._urls.deletePhoto.CM_POST_DEL;break;case 2:a={pic_id:this.albumData.pic_id},n=this._urls.deletePhoto.CM_PICTURE_DEL}$.tb.post(n,a,function(t){return 4011===t.no?void i._getCaptcha(t,e):0!=t.no?void i._hint.show(i._getErrorMsg(t.no)):void("function"==typeof e&&setTimeout(function(){e(o)},1e3))})},_getCaptcha:function(e,t){var i=this;_.Module.use("common/component/CaptchaDialog",{title:"\u5220\u9664\u8D34\u5B50",message:"\u5220\u4E86\u90A3\u4E48\u591A\u8D34\u5B50\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum_name,forumId:PageData.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){i.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){var a={vcode:e.getInputValue(),vcode_md5:e.getVCode()};i.deletePhoto.call(i,t,a)}),e.show()})},setCover:function(e,t){var i=this;$.tb.post(i._urls.setCover,{cover_pic_id:e,tid:i.pageData.tid,ie:"utf-8"},function(e){var i=0==e.no;"function"==typeof t&&t(i)})},deleteComment:function(e,t){var i=this,a=this.albumData.comment_type,n={kw:this.pageData.forum.name_url,fid:this.pageData.forum_id,tid:this.pageData.tid,tbs:this.pageData.tbs,is_finf:0},o="";switch(parseInt(a)){case 0:case 2:n.pid=e.post_id,o="/f/commit/post/delete";break;case 1:n.is_finf=1,n.pid=e.c_id,o="/f/commit/post/delete"}$.tb.post(o,n,function(a){return 224011===a.no?void i._getCaptchaCommit(a,e,t):0!=a.no?void i._hint.show(i._getErrorMsg(a.no)):void("function"==typeof t&&setTimeout(function(){t()},1e3))})},_getCaptchaCommit:function(e,t,i){var a=this;_.Module.use("common/component/CaptchaDialog",{title:"\u5220\u9664\u8D34\u5B50",message:"\u5220\u4E86\u90A3\u4E48\u591A\u8D34\u5B50\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum_name,forumId:PageData.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){a.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){var n={vcode:e.getInputValue(),vcode_md5:e.getVCode()};a.deleteComment.call(a,t,i,n)}),e.show()})},getPower:function(){var e=this.albumData,t=2==e.comment_type?e.power.del_pic:e.power.del_post,i=0==e.thread_type&&e.power.del_pic;return{"delete":t,setCover:i}},getBigViewURLByScreen:function(e){var t=e.img.original,i=e.img.screen,a=i&&i.waterurl&&""!=i.waterurl&&(window.screen.width<=i.width||window.screen.height<=i.height)?i.waterurl:t.waterurl||t.url;return a}}});
;_.Module.define({path:"common/widget/ImageViewer/DropdownList",sub:{dom:null,_options:{items:[],mouseenter:function(){},mouseleave:function(){},click:function(){}},_expandWrap:null,_timer:null,_hideDelay:100,initial:function(e,t){this.dom=e,this._options=$.extend(this._options,t),e.addClass("dropdown_list").addClass("dropdown_show_list");var i=this._options.items;this._expandWrap=$('<ul class="dropdown_expand" style="display:none;" ></ul>'),this.setItems(i),$("body").append(this._expandWrap),this._bindEvents()},setItems:function(e){this._expandWrap.empty();for(var t=0,i=e.length;i>t;t++)this._expandWrap.append('<li class="dropdown_item" >'+e[t]+"</li>")},_bindEvents:function(){var e=this;this.dom.hover(function(){e._showlist()},function(){e._hidelist()}),this._expandWrap.bind("mouseenter",function(){e._showlist()}),this._expandWrap.bind("mouseleave",function(){e._hidelist()}),this._expandWrap.delegate(".dropdown_item","click",function(t){"function"==typeof e._options.click&&e._options.click(t),t.preventDefault()}),this._expandWrap.delegate(".dropdown_item","mouseenter",function(t){"function"==typeof e._options.mouseenter&&e._options.mouseenter(t),t.preventDefault()}),this._expandWrap.delegate(".dropdown_item","mouseleave",function(t){"function"==typeof e._options.mouseleave&&e._options.mouseleave(t),t.preventDefault()})},_showlist:function(){this._clearTimeout();var e=this.dom.offset();this._expandWrap.show(),this._expandWrap.css({position:"absolute",left:e.left,top:e.top+this.dom.height()}),this.dom.removeClass("dropdown_show_list").addClass("dropdown_hide_list")},_hidelist:function(){var e=this;this._clearTimeout(),this._timer=setTimeout(function(){e._expandWrap.hide(),e.dom.addClass("dropdown_show_list").removeClass("dropdown_hide_list"),e._clearTimeout()},this._hideDelay)},_clearTimeout:function(){clearTimeout(this._timer),this._timer=null}}});
;_.Module.define({path:"common/widget/ImageViewer/FullScreenManager",sub:{initial:function(){},fullscreenEnabled:function(){var e=document.documentElement;return"requestFullscreen"in e||"webkitRequestFullScreen"in e||"mozRequestFullScreen"in e&&document.mozFullScreenEnabled||!1},requestFullScreen:function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?window.navigator.userAgent.toUpperCase().indexOf("CHROME")>=0?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()},exitFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()},fullscreenElement:function(){return document.fullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||null},isFullscreen:function(){return document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||!1},bindFullScreenChangeEvent:function(e){$(document).bind("fullscreenchange webkitfullscreenchange mozfullscreenchange",e)},removeFullScreenChangeEvent:function(){$(document).unbind("fullscreenchange webkitfullscreenchange mozfullscreenchange")}}});
;_.Module.define({path:"common/widget/ImageViewer/Hint",sub:{_container:null,_hint:null,_hintHideDelay:1500,_hintTimer:null,initial:function(){},setContainer:function(t){this._container=t},show:function(t,i,n){this._hint&&(this._hint.close(),this._hint=null),this._hintTimer&&clearTimeout(this._hintTimer);var e=this,i=i||{},h=t||"",o={time:this._hintHideDelay,modal:!1,showTitle:!1,button:!1,width:"auto"};if(i=$.extend(o,i),this._hint=$.dialog.open(h,i),this._container){var s=this._container.offset(),_=this._hint.element,l=this._container.width(),a=this._container.height(),r=(_.width(),_.height(),{left:s.left+l/2-_.width()/2,top:s.top+a/2-_.height()/2});_.offset(r)}return this._hintTimer=setTimeout(function(){e._hint&&e._hint.close&&e._hint.close(),"function"==typeof n&&n()},parseInt(i.time)),e._hint}}});
;_.Module.define({path:"common/widget/ImageViewer/ImageNavItem",requires:["common/widget/ImageViewer/DataInterface"],sub:{dom:null,idx:-2,_dc:null,_imageWidth:60,_padding:5,_activeMask:null,initial:function(){this._dc=this.getInstance("common/widget/ImageViewer/DataInterface"),this._buildUI()},_buildUI:function(){this.dom=$(['<li class="carousel_li" >','<div class="album_carousel_img img_wrap" >',"<img />","</div>","</li>"].join("")),this._activeMask=$('<div class="active_mask" >&nbsp;</div>'),this._bindEvents()},_bindEvents:function(){var i=this,t=i.dom.find(".img_wrap");t.hover(function(){t.removeClass("album_carousel_img").addClass("album_carousel_img_hover")},function(){t.removeClass("album_carousel_img_hover").addClass("album_carousel_img")}),i.dom.find("img").load(function(){$(this).show(),i.dom.removeClass("loading")})},setData:function(i){if(this.idx!=i){var t=this,e=t.dom.find("img");e.tbattr("src","about:blank"),e.hide(),this.dom.addClass("loading"),this._dc.getImageGuideByIndex(i,function(i){setTimeout(function(){var a=i.img.medium.id,s=i.img.medium.url.match(/\.\w+$/);e.css({width:i.img.medium.width,height:i.img.medium.height}),$.resizePic(e,t._imageWidth,t._imageWidth);var m=i.img.medium.host?location.protocol+"//"+i.img.medium.host+"/":"https://imgsa.baidu.com/";e.css({"margin-top":(t._imageWidth-e.height())/2}),t.dom.find("img").tbattr("src",m+"forum/abpic/item/"+a+s)},100)}),this.dom.tbattr("index",i),this.dom.css("left",(this._imageWidth+2*this._padding)*i+this._padding),this.idx=i}},setActive:function(i){var t=this.dom.find(".img_wrap");i?(this.dom.addClass("active"),t.append(this._activeMask)):(this.dom.removeClass("active"),this._activeMask.parent().length&&this._activeMask.remove())},remove:function(){this.dom.remove()}}});
;_.Module.define({path:"common/widget/ImageViewer/ImageOriginal",requires:["common/widget/ImageViewer/DataInterface","common/widget/ImageViewer/ImageThumbnail","common/widget/ImageViewer/ImagePreloader","common/widget/ImageViewer/FullScreenManager","common/widget/ImageViewer/Hint"],sub:{dom:null,_width:0,_height:0,_imgWidth:0,_imgHeight:0,_prevBtn:null,_nextBtn:null,_modeBtn:null,_needModeBtn:!1,_hint:null,_pptBtnContainer:null,_originalPre:null,_original:null,_thumbnail:null,_descBar:null,_isBuild:!1,_viewMode:"fix",_isPPTMode:!1,_datalist:null,_currData:null,_currIdx:-1,_hasDesc:!1,_wantDesc:!1,_radian:0,_dc:null,_fullScreenManager:null,_borderWeight:3,_preloader:null,_preloadLength:3,_nextOrPrev:"next",_autoplayStatus:!1,_autoTimer:null,_autoDelay:3e3,_autoTimeoutTimer:null,_autoTimeout:2e4,_pptControlHideTimer:null,_pptControlHideDelay:3e3,_containment:null,_currLoaded:!1,_state:"normal",_hasNextAlbum:!1,_loadingDur:2e3,_loadingTimer:null,_statsData:{updateStartTime:0,loadStartTime:0},_ifPostComments:1,initial:function(){this._dc=this.getInstance("common/widget/ImageViewer/DataInterface"),this._fullScreenManager=this.getInstance("common/widget/ImageViewer/FullScreenManager"),this._preloader=this.use("common/widget/ImageViewer/ImagePreloader",this._preloadLength),this._hint=this.getInstance("common/widget/ImageViewer/Hint"),this._datalist=this._dc.guide.pic_list,this._buildUI()},_buildUI:function(){if(!this._isBuild){this._isBuild=!0,this.dom=$('<div id="image_original_container" class="image_original_container" onselectstart="return false" ><div class="image_original_imagewrap" ></div></div>'),this._prevBtn=$('<a class="image_original_prev" href="#" >&nbsp;</a>'),this._nextBtn=$('<a class="image_original_next" href="#" >&nbsp;</a>'),this._modeBtn=$('<a class="image_original_mode mode_original" href="#" >&nbsp;</a>'),this._modeBtn.hide(),this._descBar=$('<div class="af_photo_desc_wrapper" style="display:none;" ><p class="af_photo_desc"></p><p class="af_photo_src"></p></div>');{this.dom.find(".image_original_imagewrap")}this.dom.append(this._prevBtn),this.dom.append(this._nextBtn),this.dom.append(this._modeBtn),this.dom.append('<div class="af_ppt_contorl" style="display:none;" ><a href="#" class="image_original_autoplay autoplay_stop" ><span>&nbsp;</span></a> <a href="#" class="image_original_cancel_ppt" ><span>&nbsp;</span></a></div>'),this.dom.append('<div class="loading" >&nbsp;</div>'),this._pptBtnContainer=this.dom.find(".af_ppt_contorl"),this.dom.append(this._descBar),this._resizePic(),this._thumbnail=this.use("common/widget/ImageViewer/ImageThumbnail"),this._thumbnail.dom&&this.dom.append(this._thumbnail.dom),this._thumbnail.dom.hide(),this._width=$(window).width(),this._height=$(window).height(),this._bindEvents()}},resize:function(i,t){"number"==typeof i&&(this._width=i-2*this._borderWeight),"number"==typeof t&&(this._height=t-2*this._borderWeight),("number"==typeof i||"number"==typeof t)&&this._resizePic()},rotate:function(i){if(this._currLoaded){if(this._radian+=i%360,this._radian%=360,this._radian<0&&(this._radian+=360),$.browser.msie&&$.browser.version<9){if(this._resizePic(),0!=this._radian)var t={0:0,90:1,180:2,270:3},e={filter:"progid:DXImageTransform.Microsoft.BasicImage(Rotation="+t[this._radian]+")"};else var e={filter:""};this._original.css(e)}else{if(this._resizePic(),0!=this._radian)var a="rotate("+this._radian+"deg)",e={"-moz-transform":a,"-webkit-transform":a,"-o-transform":a,"-ms-transform":a};else var e={"-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":""};this._original.css(e)}"original"==this._viewMode?this.toOriginalMode():this.toFixMode()}},update:function(i){return this._datalist[i]&&this._currIdx!=i?(0!=this._radian&&this.rotate(-this._radian),"original"==this._viewMode&&this.toFixMode(),i>this._currIdx?this._nextOrPrev="next":i<this._currIdx&&(this._nextOrPrev="prev"),this._currIdx=i,this._currData=this._datalist[i],this._statsData.updateStartTime=(new Date).getTime(),this.updateByData(this._currData),this._creatTpointAdIcon(),!0):!1},next:function(i){if("cross"==this._state)return void this.trigger("next_album");i&&this.setAutoPlay(!1);var t=this.update(1*this._currIdx+1),e=0==this._currIdx&&1==this._datalist.length?0:this._currIdx-1;this._ifPostComments=this._datalist[this._currIdx].post_id==this._datalist[e].post_id?0:1,t?this.trigger("image_select",this._currIdx,this._ifPostComments):this.crossTail()},prev:function(i){if("cross"==this._state)return void this.trigger("normal_state");i&&this.setAutoPlay(!1);var t=this.update(1*this._currIdx-1),e=1==this._datalist.length?0:this._currIdx+1;this._ifPostComments=this._datalist[this._currIdx].post_id==this._datalist[e].post_id?0:1,t?this.trigger("image_select",this._currIdx,this._ifPostComments):this.trigger("cross_head",this._currData)},toOriginalMode:function(){var i=this.dom.find(".image_original_imagewrap"),t=this._currData.img.original.width,e=this._currData.img.original.height,a=this._currData.img.original.url;this._viewMode="original",i.addClass("wrap_mode_original"),i.css("overflow","hidden"),i.removeClass("mouseright").removeClass("mouseleft"),this._modeBtn.removeClass("mode_original").addClass("mode_fix"),this._hideDescription(),this._original.tbattr("src")!=a&&this._original.tbattr("src",a),0==this._radian?(this._thumbnail.dom.show(),this._thumbnail.setData(this._currData.img.medium.url,t,e),this._thumbnail.setDisplaySize(this._width,this._height)):this._thumbnail.dom.hide(),this._resizePic()},toFixMode:function(){var i=this.dom.find(".image_original_imagewrap");i.removeClass("wrap_mode_original"),this._viewMode="fix",this._modeBtn.addClass("mode_original").removeClass("mode_fix"),this._thumbnail.dom.hide(),this.dom.find(".image_original_imagewrap").css("overflow",""),this._resizePic(),this._original&&this._original.data("ui-draggable")&&this._original.draggable("destroy")},toPPTMode:function(){this.toFixMode(),this._showPPTControl(),this._pptBtnContainer.find(".image_original_autoplay").removeClass("play").addClass("stop"),this._fullScreenManager.requestFullScreen(document.body),this.setAutoPlay(!0),this._isPPTMode=!0,this.trigger("to_ppt_mode")},cancelPPTMode:function(){this._isPPTMode=!1,this.toFixMode(),this._hidePPTControl(),this._fullScreenManager.exitFullScreen(),this.setAutoPlay(!1);var i=this.dom.find(".image_original_imagewrap");i.removeClass("mouse_hide"),this.trigger("cancel_ppt_mode")},getData:function(){return this._currData},crossState:function(i){var t=this;if(this._state="cross",this.toFixMode(),this._hideOriginal(),this._hideDescription(),""!=i.title&&i.picList.length>=3){this._hasNextAlbum=!0;for(var e,a='<div class="af_cross_tip af_cross_sep" >\u5373\u5C06\u4E3A\u60A8\u8DF3\u8F6C\u5230\u56FE\u8D34<h3>'+i.title+'</h3><div class="rcmd_pic_list">',s=0;2>=s;s++)e=i.picList[s],a+='<div class="rcmd_pic_cnt">'+t._getRcmdImg(e,{width:100,height:100})+"</div>";a+="</div></div>",this.dom.prepend(a)}else this._showRcmdNullTip()},normalState:function(){this._state="normal",this._showOriginal(),this.dom.find(".af_cross_tip").remove()},crossTail:function(){var i=this;this._isPPTMode?$.browser.mozilla?$.dialog.alert("\u672C\u56FE\u8D34\u5DF2\u7ECF\u64AD\u653E\u5B8C\u6BD5\uFF0C\u70B9\u51FB\u786E\u5B9A\u9000\u51FA\u5E7B\u706F\u7247\u6A21\u5F0F\u3002",{onclose:function(){i.cancelPPTMode()}}):this._hint.show("\u672C\u56FE\u8D34\u5DF2\u7ECF\u64AD\u653E\u5B8C\u6BD5\uFF0C\u5373\u5C06\u4E3A\u60A8\u9000\u51FA\u5E7B\u706F\u7247\u6A21\u5F0F\u3002",null,function(){i.cancelPPTMode()}):this._dc.guide.pic_amount>0&&this.trigger("cross_tail",this._currData)},_getRcmdImg:function(i,t){var e,a,s=i.width,o=i.height,n=0,r=0,h=t.height,_=t.width;if(a="https://imgsa.baidu.com/forum/abpic/item/"+i.id+".jpg",s>_||o>h){e=s/_>=o/h?_/s:h/o,s=parseInt(s*e),o=parseInt(o*e),r=(_-s)/2+1,n=(h-o)/2+1;var d='<img src="'+a+'" style="width:'+s+"px; height:"+o+"px; top:"+n+"px; left:"+r+'px;" class="rcmd_image">';return d}return r=(_-s)/2+1,n=(h-o)/2+1,'<img src="'+a+'" style="top:'+n+"px; left:"+r+'px;" class="rcmd_image">'},_showRcmdNullTip:function(){var i=this;this.dom.append(['<div class="af_cross_tip" >\u672C\u56FE\u8D34\u5DF2\u7ECF\u770B\u5B8C\u5566!<div id="af_rcmd_jump_content" class="af_rcmd_jump_content">','<a href="#" class="rcmd_review" >&nbsp;</a>','<a class="go_to_guangchang" href="/tb/picture/index.html">&nbsp;</a>',"</div></div>"].join("")),this.dom.find(".rcmd_review").click(function(t){i.trigger("restart"),t.preventDefault()})},setAutoPlay:function(i){var t=this.dom.find(".image_original_autoplay");this._autoplayStatus=i,i?(this._autoOriginalLoadedHandler(),t.removeClass("autoplay_play").addClass("autoplay_stop"),this._isPPTMode&&this._showPPTControl()):(clearTimeout(this._autoTimer),clearTimeout(this._autoTimeoutTimer),t.removeClass("autoplay_stop").addClass("autoplay_play"),this._isPPTMode&&this._showPPTControl())},_showPPTControl:function(){var i=this;clearTimeout(this._pptControlHideTimer),this._pptBtnContainer.show(),this._prevBtn.fadeIn(),this._nextBtn.fadeIn(),this.trigger("show_ui"),i._autoplayStatus&&(this._pptControlHideTimer=setTimeout(function(){i._hidePPTControl(),i._prevBtn.fadeOut(),i._nextBtn.fadeOut(),i.trigger("hide_ui")},this._pptControlHideDelay));var t=this.dom.find(".image_original_imagewrap");t.removeClass("mouse_hide")},_hidePPTControl:function(){clearTimeout(this._pptControlHideTimer),this._pptBtnContainer.hide();var i=this.dom.find(".image_original_imagewrap");i.addClass("mouse_hide")},_autoOriginalLoadedHandler:function(){if(this._autoplayStatus){var i=this;clearTimeout(this._autoTimer),clearTimeout(this._autoTimeoutTimer),this._autoTimer=setTimeout(function(){i.next(),i._autoTimeoutTimer=setTimeout(function(){i.next()},i._autoTimeout)},this._autoDelay)}},_showDescription:function(){if("original"==this._viewMode)return void this._hideDescription();var i=this._currData,t=i.descr,e=i.src_text,a=i.src_url,s="";t||a?(t?("\u2026"===t.slice(-1)&&t.replace(/[^\x00-\xff]/g,"--").length>=168&&(t+="<a onmouseup=\"window.open('//tieba.baidu.com/p/"+this._dc.pageData.tid+"?pid="+i.post_id+"#"+i.post_id+'\');$.stats.sendRequest(\'fr=tb0_forum&st_mod=album&st_value=yuantiebtnclick1\');" onclick="return false;" href="#" target="_blank" class="album_photo_desc_ori">\u67E5\u770B\u539F\u8D34&gt;&gt;</a>'),this._descBar.find(".af_photo_desc").html(t).show()):this._descBar.find(".af_photo_desc").html("").hide(),a?(e=e?e:a,s="<span>\u56FE\u7247\u6765\u81EA\uFF1A</span><a onmouseup=\"window.open(' "+a+' \');" onclick="return false;" href="#" target="_blank">'+e+"</a>",this._descBar.find(".af_photo_src").html(s).show()):this._descBar.find(".af_photo_src").html("").hide(),this._descBar.show(),this._hasDesc=!0):(this._descBar.find(".af_photo_desc").text(""),this._descBar.find(".af_photo_src").text(""),this._descBar.hide(),this._hasDesc=!1),this._setBtnsPosition()},_hideDescription:function(){this._descBar.hide(),this._hasDesc=!1,this._setBtnsPosition()},_bindEvents:function(){var i=this,t=this.dom.find(".image_original_imagewrap");this.dom.mouseleave(function(){i._prevBtn.fadeOut(),i._nextBtn.fadeOut(),"original"!=i._viewMode&&i._modeBtn.fadeOut(),i._wantDesc=!1,i._hideDescription()}),this.dom.mousemove(function(e){if(e.pageX!=a||e.pageY!=s){var a=e.pageX,s=e.pageY,o="normal"==i._state||i._hasNextAlbum;if(i._prevBtn.fadeIn(),o?i._nextBtn.fadeIn():i._nextBtn.fadeOut(),"normal"==i._state&&(i._wantDesc=!0,i._showDescription(),i._isPPTMode&&i._showPPTControl()),"original"!=i._viewMode){if(o){var n=i.dom.position();e.pageX-n.left<i._width/2?(t.addClass("mouseleft"),t.removeClass("mouseright")):(t.addClass("mouseright"),t.removeClass("mouseleft"))}else t.removeClass("mouseleft"),t.removeClass("mouseright");var r=i._original.offset(),h={width:i._original.width(),height:i._original.height()};imgX=a-r.left,imgY=s-r.top,imgX>0&&imgY>0&&imgX<h.width&&imgY<h.height?i._needModeBtn&&!i._modeBtn.is(":visible")&&i._modeBtn.fadeIn():"original"!=i._viewMode&&i._modeBtn.fadeOut()}}}),this.dom.delegate(".mouseleft","click",function(t){i.prev(),i.setAutoPlay(!1),t.preventDefault()}),this.dom.delegate(".mouseright","click",function(t){i.next(),i.setAutoPlay(!1),t.preventDefault()}),this.dom.delegate(".mode_original","click",function(t){i.toOriginalMode(),t.preventDefault(),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_value=fangdaclick")}),this.dom.delegate(".mode_fix","click",function(t){i.toFixMode(),t.preventDefault(),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_value=fangdaclick")}),this.dom.delegate(".image_original_cancel_ppt","click",function(){i.cancelPPTMode()}),this.dom.delegate(".autoplay_stop","click",function(){i.setAutoPlay(!1)}),this.dom.delegate(".autoplay_play","click",function(){i.setAutoPlay(!0)}),this._nextBtn.click(function(t){i.next(),i.setAutoPlay(!1),t.preventDefault()}),this._prevBtn.click(function(t){i.prev(),i.setAutoPlay(!1),t.preventDefault()}),$("body").bind("keyup",function(t){32==t.keyCode&&i._isPPTMode&&(i.setAutoPlay(!i._autoplayStatus),t.preventDefault()),27==t.keyCode&&i._isPPTMode&&i.cancelPPTMode()}),this.dom.mousewheel(function(t,e){"fix"==i._viewMode?0>e?i.next():i.prev():i._originalMouseWheelHandler(e)}),this._thumbnail.bind("display_position_change",function(t,e){i._thumbnailChangeHandler(t,e)}),this.bind("original_loaded",this._autoOriginalLoadedHandler,this),this._fullScreenManager.bindFullScreenChangeEvent(function(){!i._fullScreenManager.isFullscreen()&&i.cancelPPTMode()})},_checkDisplayMode:function(){var i,t,e=this._currData.img.original,a=e.width,s=e.height;this._radian%180==0?(i=a,t=s):(i=s,t=a),this._currLoaded&&!this._isPPTMode&&(this._width<i||this._height<t)?this._needModeBtn=!0:(this._needModeBtn=!1,this._modeBtn.hide(),"original"==this._viewMode&&this.toFixMode())},_thumbnailChangeHandler:function(i,t){var e={},a=this._currData.img.original;a.width>this._width&&(e.left=-t.x),a.height>this._height&&(e.top=-t.y),this._original.css(e)},_resizePic:function(i){var t,e,a,s,o=this._viewMode,n=this._currData&&this._currData.img.original||{},r=this._width-2*this._borderWeight,h=this._height-2*this._borderWeight,_=n.width||0,d=n.height||0;if("fix"==o){if((_>r||d>h)&&this._radian%180==0){var l=_/d;l>=r/h?(t=r,e=t/l):(e=h,t=e*l)}else if((d>r||_>h)&&this._radian%180!=0){var l=d/_;l>=r/h?(e=r,t=e/l):(t=h,e=t*l)}else t=_,e=d;$.browser.msie&&$.browser.version<9&&this._radian%180!=0?(a=(h-t)/2,s=(r-e)/2):(a=(h-e)/2,s=(r-t)/2);var g={width:t,height:e,top:a,left:s};i?i.css(g):(this._original&&this._original.css(g),this._originalPre&&this._originalPre.css(g))}else if("original"==o){t=_,e=d,$.browser.msie&&$.browser.version<9?this._radian%180!=0?(a=-(t-h)/2,s=-(e-r)/2,a+=Math.max((t-h)/2,0),s+=Math.max((e-r)/2,0)):(a=-(e-h)/2,s=-(t-r)/2,a+=Math.max((e-h)/2,0),s+=Math.max((t-r)/2,0)):(a=-(e-h)/2,s=-(t-r)/2,this._radian%180!=0?(a+=Math.max((t-h)/2,0),s+=Math.max((e-r)/2,0)):(a+=Math.max((e-h)/2,0),s+=Math.max((t-r)/2,0))),0==this._radian&&this._thumbnail.setDisplaySize(r,this._height);var g={width:t,height:e,top:a,left:s};i?i.css(g):(this._original&&this._original.css(g),this._originalPre&&this._originalPre.css(g)),i||(this._originalChangeHandler(this._original.offset()),this._containment=this._getOriginalContainment(),this._original.draggable(this._containment))}this._imgWidth=t,this._imgHeight=e,this._setBtnsPosition(),this._currData&&this._checkDisplayMode()},_creatTpointAdIcon:function(){var i=this._datalist[this._currIdx].tag_name;this._tpointAdIcon&&this._tpointAdIcon.remove(),this._currIdx>=0&&i&&(this._tpointAdIcon=$('<div class="tpoint-promotion-type">'+i+"</div>"),this.dom.find(".image_original_imagewrap").append(this._tpointAdIcon),this._setTpointAdsPosition())},_setTpointAdsPosition:function(){if(this._original&&this._tpointAdIcon){var i={position:"absolute",zIndex:3,right:parseInt(this._original.css("left"),10)+9+"px",top:parseInt(this._original.css("top"),10)+3+"px",padding:2,backgroundColor:"#666",height:14,color:"#fff",lineHeight:"16px",opacity:.75};this._tpointAdIcon.css(i)}},_setBtnsPosition:function(){if(!this._original)return void this._modeBtn.hide();var i,t=this._imgWidth,e=this._imgHeight,a=this._descBar.outerHeight();if(i=this._radian%180!=0?(this._height-t)/2+18:(this._height-e)/2+18,this._hasDesc&&(i=parseInt(this._descBar.css("bottom"))+a+9),"fix"==this._viewMode){var s,o,n,r,h=this._modeBtn.width(),_=this._modeBtn.height();this._radian%180==0?(n=t,r=e):(n=e,r=t),n>=h+26&&r>=_+26?(s=(this._width-n)/2+13,o=(this._height-r)/2+2):r>=n&&h>n?(s=(this._width-n)/2-h-10,o=(this._height-r)/2):r>=n&&n>=h?(s=(this._width-n)/2,o=(this._height-r)/2):(s=(this._width-n)/2,o=(this._height-r)/2-_-10),this._hasDesc&&(o=Math.max(i,o)),this._modeBtn.css({right:s,bottom:o})}else if("original"==this._viewMode){var d="none"!=this._thumbnail.dom.css("display")?1:0;this._modeBtn.css({right:(parseInt(this._thumbnail.dom.css("right"))+this._thumbnail.dom.width())*d+10,bottom:parseInt(this._thumbnail.dom.css("bottom"))})}this._isPPTMode&&this._pptBtnContainer.css({bottom:a+9})},_updateOriginal:function(){var i=this;this._original&&(this._original.tbattr("src","about:blank"),this._original.remove()),this._originalPre&&(this._originalPre.tbattr("src","about:blank"),this._originalPre.remove()),this._original=$('<img class="image_original_original" style="z-index:2;" />'),this._originalPre=$('<img class="image_original_original_pre" style="z-index:1;" />'),this._original.on("drag",function(t,e){if(e){var a=e.position;i._originalChangeHandler(a)}}),this.dom.find(".image_original_imagewrap").append(this._originalPre),this.dom.find(".image_original_imagewrap").append(this._original),this._original.bind("load",function(){i._originalloadedHandler(),i._original.unbind("load")}),i._checkDisplayMode()},_originalMouseWheelHandler:function(i){if(this._containment){var t,e,a=this._containment.containment,s=this.dom.find(".image_original_imagewrap"),o=this._currData.img.original.width,n=this._currData.img.original.height,r=s.offset(),h={left:parseInt(this._original.css("left"),10),top:parseInt(this._original.css("top"),10)};this._radian%180==0?(e=n-s.height())>0?(t=e/10,h.top=Math.min(Math.max(h.top+i*t,a[1]-r.top),a[3]-r.top)):(e=o-s.width())>0&&(t=e/10,h.left=Math.min(Math.max(h.left+i*t,a[0]-r.left),a[2]-r.left)):(e=o-s.height())>0?(t=e/10,h.top=Math.min(Math.max(h.top+i*t,a[1]-r.top),a[3]-r.top)):(e=n-s.width())>0&&(t=e/10,h.left=Math.min(Math.max(h.left+i*t,a[0]-r.left),a[2]-r.left)),this._original.css(h),this._originalChangeHandler(h)}},_getOriginalContainment:function(){var i,t=this.dom.find(".image_original_imagewrap"),e=t.offset(),a=Math.floor(this._currData.img.original.width),s=Math.floor(this._currData.img.original.height),o=this._original.position();if(originalTop=o.top,originalLeft=o.left,axis="xy",this._radian%180==0){var n=-a+this._width+e.left,r=-s+this._height+e.top,h=e.left,_=e.top;a>this._width&&s>this._height?i=[n,r,h,_]:s>this._height?(i=[0,r,0,_],axis="y"):a>this._height&&(i=[n,0,h,0],axis="x")}else if($.browser.msie&&$.browser.version<9){var n=-s+this._width+e.left,r=-a+this._height+e.top,h=e.left,_=e.top;s>this._width&&a>this._height?i=[n,r,h,_]:a>this._height?(i=[0,r,0,_],axis="y"):s>this._width&&(i=[n,0,h,0],axis="x")}else{var d=(s-a)/2,n=-s+this._width+e.left+d,r=-a+this._height+e.top-d,h=e.left+d,_=e.top-d;s>this._width&&a>this._height?i=[n,r,h,_]:a>this._height?(i=[0,r,0,_],axis="y"):s>this._width&&(i=[n,0,h,0],axis="x")}return{containment:i,axis:axis}},_imageIsComplete:function(i){var i=i.get(0)||i,t=1==i.complete;return t},updateByData:function(i){this._currLoaded=!1;this._currData=i,this._original&&this._original.stop();var t=this._currData.img.medium,e=t.id,a=t.url.match(/\.\w+$/),s=this._dc.getBigViewURLByScreen(this._currData),o=t.host?location.protocol+"//"+t.host+"/":"https://imgsa.baidu.com/",n=o+"forum/abpic/item/"+e+a;return this._statsData.loadStartTime=(new Date).getTime(),this._original&&this._original.tbattr("src")==s&&this._imageIsComplete(this._original)?this._currLoaded=!0:(this._updateOriginal(),this._startLoadingState(),this._originalPre&&this._originalPre.tbattr("src",n),this._original.tbattr("src",s),this._resizePic()),this._wantDesc&&this._showDescription(),this.trigger("change_image",t.id),!0},_originalloadedHandler:function(){this._currLoaded=!0;var i=this;i._stopLoadingState(),i._preloader.preload(i._currIdx,i._nextOrPrev),i._originalPre&&(i._originalPre.remove(),i._originalPre=null),i._checkDisplayMode(),i.trigger("original_loaded"),i._statsSend()},_originalChangeHandler:function(i){this._thumbnail.setDisplayPosition(-i.left,-i.top)},_showOriginal:function(){this._original.show(),this._originalPre&&this._originalPre.show(),this._checkDisplayMode()},_hideOriginal:function(){this._original.hide(),this._originalPre&&this._originalPre.hide(),this._modeBtn.hide()},_startLoadingState:function(){var i=this;this._loadingTimer&&(clearTimeout(this._loadingTimer),this._loadingTimer=null),this._loadingTimer=setTimeout(function(){i.dom.addClass("original_loading")},this._loadingDur)},_stopLoadingState:function(){this._loadingTimer&&(clearTimeout(this._loadingTimer),this._loadingTimer=null),this.dom.removeClass("original_loading")},_statsSend:function(){var i=(new Date).getTime();$.stats.sendRequest("fr=photo&st_mod=screen_update&st_val="+(i-this._statsData.updateStartTime).toString()),$.stats.sendRequest("fr=photo&st_mod=screen_load&st_val="+(i-this._statsData.loadStartTime).toString()),this._statsData.updateStartTime=0,this._statsData.loadStartTime=0}}});
;_.Module.define({path:"common/widget/ImageViewer/ImagePager",sub:{dom:null,_pageCurr:0,_pageTotal:0,_isBuild:!1,initial:function(){this.dom=$('<div class="js_pager" ></div>'),this._bindEvents()},getDom:function(){return this.dom},setData:function(a,e){this._pageCurr=parseInt(a)||0,this._pageTotal=parseInt(e)||0,this.buildUI(),this._changeCurrState(this._pageCurr)},buildUI:function(){this._isBuild||(this.dom.html(['<span class="status">','<span class="js_pager_idx" >'+this._pageCurr+'</span><span>/</span><span class="js_pager_total">'+this._pageTotal+"</span>","</span>",'<a href="#" class="head" >&nbsp;</a>','<a href="#" class="prev" >&nbsp;</a>','<a href="#" class="next" >&nbsp;</a>','<a href="#" class="tail" >&nbsp;</a>'].join("")),this._isBuild=!0)},_bindEvents:function(){var a=this,e=this.dom;e.delegate(".head","click",function(e){a._changeCurrState(1),e.preventDefault()}),e.delegate(".prev","click",function(e){a._changeCurrState(Math.max(a._pageCurr-1,1)),e.preventDefault()}),e.delegate(".next","click",function(e){a._changeCurrState(Math.min(a._pageCurr+1,a._pageTotal)),e.preventDefault()}),e.delegate(".tail","click",function(e){a._changeCurrState(a._pageTotal),e.preventDefault()})},_changeCurrState:function(a){this.dom.find(".js_pager_idx").text(a),this.dom.find(".js_pager_total").text(this._pageTotal),1==a?(this.dom.find(".head").addClass("head_disable"),this.dom.find(".prev").addClass("prev_disable")):a>1&&(this.dom.find(".head").removeClass("head_disable"),this.dom.find(".prev").removeClass("prev_disable")),a==this._pageTotal?(this.dom.find(".next").addClass("next_disable"),this.dom.find(".tail").addClass("tail_disable")):a<this._pageTotal&&(this.dom.find(".next").removeClass("next_disable"),this.dom.find(".tail").removeClass("tail_disable")),a!=this._pageCurr&&(this._pageCurr=a,this.trigger("page_change",a))}}});
;_.Module.define({path:"common/widget/ImageViewer/ImagePostor",requires:["common/widget/PicPoster"],sub:{initial:function(t){this._pageData=t.pageData,this._data=t.cData,this._container=t.wrap,this._initPicPostor()},_initPicPostor:function(){var t=this._pageData,i=this,o=this._data.img,e=o.original.id?!1:!0,s=t.user.has_grade?t.user.grade_level:0,a={kw:t.forum_name,rich_text:1,floor_num:1,fid:t.fid,tid:t.tid,quote_id:0,pic_id:"",anonymous:0,tbs:t.tbs},r={_canPost:t.can_post,_forumType:i._convertFlag(t.forum_type),_cpStyle:"tpl",_noUn:t.user.no_un,_isBlock:!1,_login:t.user.is_login,_submitUrl:i._imagePostorURL.CM_PB_POST,_dataPostor:a,_reach_limit:!1,_img_del:e,_needSmile:!0,_container:i._container},_={autoFocus:!0,autoEnable:!0,height:"52px",maxHeight:"52",width:"240px",enableRefer:!0,bavl:s},n={pOp:r,eOp:_};this._imagePostor=this.use("common/widget/PicPoster",n),this.resetEditorData(this._data),this._smileyClickTrick(),this._postorErrorConfig(),this._imagePostor.focusSelf()},_imagePostorURL:{CM_PB_POST:"/f/commit/post/add",CM_ALBUM_POST:"/photo/cm/comment/add"},_postorErrorConfig:function(){var t={901:{message:"\u672C\u56FE\u7247\u56DE\u590D\u5DF2\u8FBE\u4E0A\u9650\uFF0C\u8BF7\u53C2\u4E0E\u5176\u4ED6\u56FE\u7247\u8BA8\u8BBA"},814:{message:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u8868\u60C5\u4E0D\u80FD\u8D85\u8FC710\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4"},902:{message:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u8F93\u5165\u7684\u6587\u5B57\u4E0D\u80FD\u8D85\u8FC7140\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4"}};this._imagePostor.setErrorConfig(t)},_convertFlag:function(t){var i={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:1};return i[t]},resetEditorData:function(t){var i=t,o=this;switch(parseInt(i.comment_type)){case 0:this._imagePostor.setDataPostor({quote_id:0,pic_id:""}),this._imagePostor.setSubmitUrl(o._imagePostorURL.CM_PB_POST);break;case 1:this._imagePostor.setDataPostor({quote_id:i.post_id,pic_id:""}),this._imagePostor.setSubmitUrl(o._imagePostorURL.CM_PB_POST);break;case 2:this._imagePostor.setDataPostor({quote_id:0,pic_id:i.pic_id}),this._imagePostor.setSubmitUrl(o._imagePostorURL.CM_ALBUM_POST)}},getPostor:function(){return this._imagePostor},_smileyClickTrick:function(){if(!this._smileyTrick){var t={width:420,height:355,left:-435,top:-164},i={left:420,top:165},o=this._container,e=o.find(".tb-editor-overlay"),s=e.find(".arrow"),a=o.find(".j_btn_smile");a.bind("click",function(o){var r=$(o.target);if(r.hasClass("j_btn_smile")||r.hasClass("insertsmiley_holder")){var _=a.offset(),n=$(window).scrollTop()+$(window).height()-_.top;if(199>n){var c=n-199;e.css($.extend({},t,{top:t.top+c})),s.css($.extend({},i,{top:i.top-c}))}else e.css($.extend({},t)),s.css($.extend({},i))}}),this._smileyTrick=!0}}}});
;_.Module.define({path:"common/widget/ImageViewer/ImagePreloader",requires:["common/widget/ImageViewer/DataInterface"],sub:{_dc:null,_cacheRange:[],_cacheList:[],_cacheLength:0,initial:function(e){this._dc=this.getInstance("common/widget/ImageViewer/DataInterface"),this._cacheLength=e||0},preload:function(e,t){for(var a=[],i=0;i<this._cacheLength;i++){var n;"prev"==t&&(n=e-i-1),"next"==t&&(n=e+i+1),a.push(n),$.inArray(n,this._cacheRange)>0||this._preloadStart(n)}this._cacheRange=a},getCache:function(e){for(var t=0,a=this._cacheList.length;a>t;t++){var i=this._cacheList[t];if(e(i))return i}return null},getCacheStatus:function(e){var t=this.getCache(function(t){return t.index==e});return t?t.status:!1},_preloadStart:function(e){var t=this.getCache(function(t){return t.index==e});if(t)return t;var a=this._dc.guide.pic_list[e];return a?(t=this._getPreloadObj(),!t&&this._cacheList.length<this._cacheLength&&(t=this._createPreloadObj()),t?(t.index=e,t.status=!1,t.img.tbattr("src",this._dc.getBigViewURLByScreen(a)),t):!1):!1},_createPreloadObj:function(){var e=$("<img />");return obj={index:0,status:!1,img:e},e.data("cacheObj",obj),e.bind("load",this._preloadedHandler),this._cacheList.push(obj),obj},_getPreloadObj:function(){var e=this;return this.getCache(function(t){return $.inArray(t.index,e._cacheRange)<0})},_preloadedHandler:function(){var e=$(this).data("cacheObj");e.status=!0}}});
;_.Module.define({path:"common/widget/ImageViewer/ImageThumbnail",sub:{dom:null,_src:"",_img:null,_imgWrap:null,_displayMask:null,_originalWidth:0,_originalHeight:0,_displayWidth:0,_displayHeight:0,_maskWidth:0,_maskHeight:0,_displayPos:{x:0,y:0},_isLoaded:!1,_maskBorderWeight:2,initial:function(){this._buildUI(),this._bindEvents()},_buildUI:function(){this.dom=$('<div class="af_thumbnail" ></div>'),this._imgWrap=$('<div class="af_thumbnail_imgwrap" style="display:none" ></div>'),this._displayMask=$('<div class="af_display_mask" ><div></div></div>'),this._img=$("<img />"),this.dom.append(this._imgWrap),this._imgWrap.append(this._img),this._imgWrap.append(this._displayMask)},_bindEvents:function(){var i=this;this._img.bind("load",function(){$.browser.msie&&!i._img.get(0).complete?setTimeout(arguments.callee,100):i._imgLoaded()}),this._displayMask.on("drag",function(t,s){if(s){{var a=s.position,h=i._img.width(),d=i._img.height();i._maskBorderWeight}i._displayPos={x:a.left/h*i._originalWidth,y:a.top/d*i._originalHeight},i.trigger("display_position_change",i._displayPos)}})},_imgLoaded:function(){var i=this,t=i.dom.width(),s=i.dom.height(),a=this._img;this._imgWrap.show(),a.removeAttr("style"),$.resizePic(a,t,s);var h=a.width(),d=a.height();this._imgWrap.css({width:h,height:d,margin:(s-d)/2+"px auto"}),this._resizeDisplayMask();var e=this._displayMask.parent(),_=e.offset(),o=this._maskWidth+2*this._maskBorderWeight,l=this._maskHeight+2*this._maskBorderWeight;this._displayMask.draggable({containment:[_.left,_.top,_.left+e.width()-o,_.top+e.height()-l]}),this._isLoaded=!0},_resizeDisplayMask:function(){var i=this._img.width(),t=this._img.height(),s=this._maskBorderWeight,a=Math.floor(Math.min(this._displayWidth/this._originalWidth*i,i))-2*s,h=Math.floor(Math.min(this._displayHeight/this._originalHeight*t,t))-2*s,d=Math.floor(Math.max(this._displayPos.y/this._originalHeight*t,0)),e=Math.floor(Math.max(this._displayPos.x/this._originalWidth*i,0));this._displayWidth>=this._originalWidth&&(e=0),this._displayHeight>=this._originalHeight&&(d=0),this._maskWidth=a,this._maskHeight=h,this._displayMask.css({width:a,height:h,top:d,left:e})},setData:function(i,t,s){this._originalWidth=t,this._originalHeight=s,this._imgWrap.hide(),this._src!=i?(this._isLoaded=!1,this._src=i,this._img.tbattr("src",i)):this._imgLoaded()},setDisplaySize:function(i,t){this._displayWidth=i,this._displayHeight=t,this._isLoaded&&this._resizeDisplayMask()},setDisplayPosition:function(i,t){this._displayPos.x=i,this._displayPos.y=t,this._isLoaded&&this._resizeDisplayMask()}}});
;_.Module.define({path:"common/widget/ImageViewer/ScrollPannel",sub:{dom:null,_wrap:null,_listWrap:null,_scroll:null,_scrollBar:null,_hasScroll:!1,_scrollStep:50,_scrollTop:0,_maxHeight:0,initial:function(){this._buildUI(),this._bindEvents()},_buildUI:function(){this.dom=$('<div class="scroll_pannel"  ></div>'),this.dom.html(['<div class="pannel_wrap" style="overflow:hidden;" ><ul></ul></div>','<div class="pannel_scroll" style="position:absolute;" >','<div class="pannel_scroll_bar" style="position:absolute; left:0; top:0;" >&nbsp;</div>',"</div>"].join("")),this._wrap=this.dom.find(".pannel_wrap:first"),this._scroll=this.dom.find(".pannel_scroll:first"),this._scrollBar=this.dom.find(".pannel_scroll_bar:first"),this._listWrap=this._wrap.find("ul:first")},_bindEvents:function(){var l=this,s=l._wrap.get(0);this._scrollBar.on("drag",function(t,i){if(i){var o=i.position;s.scrollTop=o.top/l._wrap.height()*s.scrollHeight}}),this._wrap.mousewheel(function(s,t){l._hasScroll&&l.scrollTopTo(l._scrollTop-t*l._scrollStep)})},scrollTopTo:function(l){var s=this,t=s._wrap.get(0),l=Math.max(Math.min(l,t.scrollHeight-s._wrap.height()),0);l!=s._scrollTop&&(s._scrollTop=l,s._wrap.stop(),s._wrap.animate({scrollTop:s._scrollTop},{duration:800,step:function(){s._resizeScroll()}}))},setHeight:function(l){this._maxHeight=l,this._resizeHeight(),this._resizeScroll(),this._scrollBar.draggable({containment:"parent"})},setContent:function(l){this._listWrap.html(l),this._wrap.get(0).scrollTop=this._scrollTop=0,this._resizeHeight(),this._resizeScroll()},appendContent:function(l){this._wrap.get(0);this._listWrap.append(l),this._resizeHeight(),this.scrollTopTo(2e4)},clearContent:function(){this.setContent("")},_resizeHeight:function(){this._wrap.css("height","");var l=this._wrap.get(0),s=l.scrollHeight,t=Math.min(s,this._maxHeight);this._wrap.css("height",t)},_resizeScroll:function(){var l=this._wrap.get(0),s=l.scrollHeight,t=l.scrollTop,i=this._wrap.innerHeight();i>=s?(this._scroll.hide(),this._hasScroll=!1):(this._scroll.show(),this._scroll.height(i),this._scrollBar.height(i/s*i),this._scrollBar.css("top",t/s*i),this._hasScroll=!0)}}});
;_.Module.define({path:"common/widget/ImageViewer/tbFav",requires:[],sub:{defaultConf:{appid:"314406",uploadUrl:"http://up.xiangce.baidu.com/",userId:0,cacheEnabled:!0},defaultData:{imgUrl:"",sourceURL:"",tags:"",descript:""},conf:{},data:{},cache:{},initial:function(){this.conf=$.extend(this.conf,this.defaultConf),this.data=$.extend(this.data,this.defaultData)},setConf:function(t){this.conf=$.extend(this.conf,t)},setData:function(t){this.data=$.extend(this.data,t)},getConf:function(){return this.conf},getData:function(){return this.data},checkStatus:function(t){t&&this.setData(t);var e=this,a=this.conf,t=this.data;return a.cacheEnabled&&this.checkCache(t.imgUrl)?void e.trigger("check_status_success","hit_cache"):void 0},addToFav:function(t){t&&this.setData(t);var e=this,a=this.conf,t=this.data,c=a.uploadUrl+"opencom/picture/fav/upload?app_id="+a.appid+"&descript="+encodeURIComponent(t.descript)+"&uid="+a.userId+"&source_url="+encodeURIComponent(t.sourceURL)+"&tags="+encodeURIComponent(t.tags)+"&url="+encodeURIComponent(t.imgUrl)+"&callback=?";$.getJSON(c,function(t){if(e.cacheEnabled){var c=0==t.errno;e.setCache(a.imgUrl,c)}e.trigger("add_to_fav_success",t)})},setCache:function(t,e){this.cache[t]=e?1:0},checkCache:function(t){return this.cache[t]}}});
;!function(){window.Path={map:function(t){return this.routes.defined[t]||(this.routes.defined[t]=new this.Route(t)),this.routes.defined[t]},pushState:!0,listened:!1,isDispatch:!0,listen:function(){this.listened=!0,this.supported=!!(window.history&&window.history.pushState&&this.pushState),this.oldIE=navigator.userAgent.toLowerCase().search("msie")>0&&(!document.documentMode||document.documentMode<8);var t,i;this.supported?(t=function(){window.Path.isDispatch&&Path.dispatch(location.pathname+location.search)},window.onpopstate=t,i=location.pathname+window.location.search):(i=this.getHash(location),this.oldIE?(this.iframe=document.createElement('<iframe src="javascript:0" tabindex="-1">'),this.iframe.style.display="none",document.body.appendChild(this.iframe),this.iframe=this.iframe.contentWindow,this.iframe.document.open().close(),this.iframe.location.hash=i,t=function(){window.Path.isDispatch&&Path.iframe&&Path.iframe.location&&Path.dispatch(Path.getHash(Path.iframe.location))},setInterval(t,50)):(t=function(){window.Path.isDispatch&&Path.dispatch(location.hash.replace("#",""))},window.onhashchange=t),""!==i&&this.execute(i)),this.routes.current=i},nav:function(t){this.listened&&(this.supported?(window.history.pushState(null,null,t),this.dispatch(t)):this.oldIE?(this.iframe.document.open().close(),this.iframe.location.hash=t):window.location.hash=t)},refresh:function(){this.execute(this.routes.current,!0)},setDefaultAction:function(t){this.defaultAction=t},Route:function(t){this.action=null,this.path=t},routes:{current:null,defined:{}},dispatch:function(t){t!==this.routes.current&&(this.routes.current=t,this.oldIE&&(location.hash=t),this.execute(t))},execute:function(t,i){""===t&&(t=location.pathname+location.search);var e,n;for(var o in Path.routes.defined)if(e=Path.routes.defined[o],n=Path.match(e.path,t))return void e.action.apply(e,n);"function"==typeof this.defaultAction&&this.defaultAction.call(this,t,i)},match:function(t,i){var e=[i];if(t=t.split("/"),i=i.split("/"),t.length!==i.length)return!1;for(var n,o=0,a=t.length;a>o;o++)if(n=t[o].search(":"),-1!==n){if(t[o].slice(0,n)!==i[o].slice(0,n))return!1;e.push(i[o].slice(n))}else if(t[o]!==i[o])return!1;return e},getHash:function(t){var i=t.href.match(/#(.*)$/);return i?i[1]:""}},Path.Route.prototype={to:function(t){this.action=t}}}();
;_.Module.define({path:"common/widget/ImageViewer/ImageComments",requires:["common/widget/ImageViewer/ImagePager","common/widget/ImageViewer/ScrollPannel","common/widget/ImageViewer/ImagePostor","common/widget/ImageViewer/ImageFilterUser","common/widget/BlockUser"],sub:{dom:null,pn:1,_dc:null,_container:null,_index:0,_currData:null,_replyAmount:null,_replyList:null,_pagerWrap:null,_commentContainer:null,_pager:null,_isBuild:!1,_uiTemp:['<div class="af_thread_head" >','<h3 class="af_thread_title" ><a href="/p/#{thread_id}" target="_blank" >#{title}</a></h3>','<div class="af_thread_desc" >','<a href="#{user_link}" class="creator" target="_blank" >#{creator_name}</a> #{create_type}','<span class="af_thread_create_time" >#{create_time}</span>',"</div>","</div>",'<div class="af_reply_amount" ></div>','<div class="af_reply_list" ></div>','<div class="af_reply_pager" ></div>','<div class="af_reply_editor_entry" >\u6211\u4E5F\u8BF4\u4E00\u53E5</div>','<div  class="af_reply_editor" id="af_reply_editor"></div>'].join(""),_itemTemp:['<li class="af_reply_li" >','<div class="af_reply_li_main_misc" >#{itieba_link}','<span class="af_reply_li_main_content" >#{content}</span>',"</div>",'<div class="af_reply_li_main_misc_time" >#{time}</div>','<div class="af_reply_li_main_power" style="display:none"  >','<a href="#" class="j_ban" cm_id="#{id}" c_id="#{c_id}" post_id="#{post_id}" user_name="#{user_name}" is_anonymous="#{is_anonymous}" style="display:none" >\u5C01</a>','<a href="#" class="j_delete" cm_id="#{id}" c_id="#{c_id}" post_id="#{post_id}" user_name="#{user_name}" is_anonymous="#{is_anonymous}" style="display:none" >\u5220\u9664</a>',"</div>","</li>"].join(""),initial:function(e){this.requireInstance("common/widget/ImageViewer/ImageFilterUser",[]),this.dom=$('<div class="af_reply_container" ></div>'),this._dc=this.getInstance("common/widget/ImageViewer/DataInterface"),this._pageData=e},_buildUI:function(){if(!this._isBuild){this._isBuild=!0;var e=this._uiTemp;e=e.format(this._currData),this.dom.html(e.toString()),this._replyAmount=this.dom.find(".af_reply_amount"),this._replyList=this.dom.find(".af_reply_list"),this._pagerWrap=this.dom.find(".af_reply_pager"),this._editorEntry=this.dom.find(".af_reply_editor_entry"),this._postorWrap=this.dom.find(".af_reply_editor"),this._commentContainer=this.requireInstance("common/widget/ImageViewer/ScrollPannel",[]),this._pager=this.requireInstance("common/widget/ImageViewer/ImagePager",[]),this._resetHeight(),this._replyList.append(this._commentContainer.dom),this._pagerWrap.append(this._pager.dom),this._bindEvents()}},_bindEvents:function(){var e=this;$(window).resize(function(){e._resetHeight()}),this._pager.bind("page_change",function(t,i){e._changePage(i)}),this._editorEntry.bind("click",function(){e._initImagePostor()}),this.dom.delegate(".j_ban","click",function(t){var i=$(this),a={post_id:i.tbattr("post_id"),user_name:i.tbattr("user_name"),is_anonymous:i.tbattr("is_anonymous")};e._banUser(a),t.preventDefault()}),this.dom.delegate(".j_delete","click",function(t){var i=$(this),a={post_id:i.tbattr("post_id"),user_name:i.tbattr("user_name"),is_anonymous:i.tbattr("is_anonymous"),c_id:i.tbattr("c_id"),id:i.tbattr("cm_id")};e._deleteComment(a),t.preventDefault()}),this.dom.delegate(".af_reply_li","mouseenter",function(){$(this).find(".af_reply_li_main_power").show()}),this.dom.delegate(".af_reply_li","mouseleave",function(){$(this).find(".af_reply_li_main_power").hide()})},_initImagePostor:function(){var e=this;if(e._imagePostor)e._editorEntry.hide(),e._postorWrap.show(),e._imagePostor.getPostor().focusSelf();else{var t={cData:e._currData,pageData:e._pageData,wrap:e._postorWrap};e._imagePostor=this.requireInstance("common/widget/ImageViewer/ImagePostor",[t]),e._imagePostor.getPostor().bind("onsuccess",function(){e._editorEntry.show(),e._postorWrap.hide();var t={content:e._imagePostor.getPostor()._getHtml(),user_id:e._pageData.user.id,user_name:e._pageData.user.name,itieba_link:'<span class="af_reply_li_main_misc_user" >'+e._pageData.user.name+"</span>&nbsp;",time:$.dateFormat(new Date,"yyyy-MM-dd HH:mm")};e.appendItem(t)}),e._editorEntry.hide()}},_resetHeight:function(){var e=this.dom.find(".af_thread_head"),t=this.dom.find(".js_pager"),i=this.dom.parent();this._commentContainer.setHeight(i.height()-e.outerHeight()-t.height()-340)},_buildReplyList:function(e){for(var t="",i=0,a=e.length;a>i;i++){var n=this._itemTemp,s=e[i];s.content=s.content.replace(/<a[^<>]*\/?>/g,""),n=n.format(s),t+=n}this._commentContainer.setContent(t)},_updatePager:function(){var e=this._currData.cur_page,t=this._currData.total_page;this._pager.setData(e,t),!t||2>t?this._pagerWrap.hide():this._pagerWrap.show()},_changePage:function(e){var t=this;this._dc.getCommentList(this._index,e,function(e,i){t.update(e.data,i,!0)}),this.trigger("change_page",e)},_deleteComment:function(e){var t=this;this._dc.deleteComment(e,function(){t._changePage(t.pn)})},_banUser:function(e){this.requireInstance("common/widget/BlockUser",[[{username:e.user_name,pid:e.post_id}],PageData.power,{forum_name:PageData.forum_name,forum_id:PageData.forum_id},PageData.tbs])},update:function(e,t,i){if("number"==typeof t&&(this._index=t),e&&(this._currData=e),i){var a="";a=this._currData.comment_amount>0?"\u5171"+this._currData.comment_amount+"\u56DE\u590D":"",!this._isBuild&&this._buildUI(),this._replyAmount.text(a),this._currData.comment_list&&this._buildReplyList(this._currData.comment_list),this._imagePostor&&this._imagePostor.resetEditorData(this._currData),this._updatePager();var n=this._dc.albumData.power;n.del_post&&this.dom.find(".j_delete").show(),(n.ban_id||n.ban_ip)&&this.dom.find(".j_ban").show()}},appendItem:function(e){var t=this._itemTemp;t=t.format(e),this._commentContainer.appendContent(t)}}});
;_.Module.define({path:"common/widget/ImageViewer/ImageNav",requires:["common/widget/ImageViewer/ImageNavItem","common/widget/ImageViewer/DataInterface"],sub:{dom:null,_dc:null,_data:null,_width:0,_itemWidth:70,_itemPadding:5,_isBuild:!1,_list:[],_listObj:{},_prevBtn:null,_nextBtn:null,_wrap:null,_listWrap:null,_idx:0,_displayRange:[],_maxDisplayAmount:19,_nextAble:!1,_prevAble:!1,_scrollSpeed:500,_isScrolling:!1,initial:function(){this._dc=this.getInstance("common/widget/ImageViewer/DataInterface"),this._buildUI()},init:function(t,i){this._data=this._dc.guide,this._idx=t,this.setSize(i)},_buildUI:function(){this._isBuild||(this._isBuild=!0,this.dom=$('<div class="carousel_wrapper" onselectstart="return false" style="display:none;" ></div>'),this._prevBtn=$('<div class="carousel_arrow_prev" >&nbsp;</div>'),this._nextBtn=$('<div class="carousel_arrow_next" >&nbsp;</div>'),this._wrap=$('<div class="carousel_ul_wrapper"  ></div>'),this._listWrap=$('<ul class="carousel_ul" ></ul>'),this.dom.append(this._prevBtn),this.dom.append(this._wrap),this.dom.append(this._nextBtn),this._wrap.append(this._listWrap),this._bindEvents())},_bindEvents:function(){var t=this;this._prevBtn.bind("click",function(i){t._prevBtnClickHandler(),i.preventDefault()}),this._nextBtn.bind("click",function(i){t._nextBtnClickHandler(),i.preventDefault()}),this.dom.delegate(".j_carousel_item","click",function(i){!t._isScrolling&&t._itemClickHandler($(this)),i.preventDefault()});var i;this.dom.mousewheel(function(e,s){i*s>0&&t._isScrolling||(i=-Math.floor(s),t.scroll(i,!0))})},_buildItems:function(){var t=this._displayRange,i=t[1]-t[0]+1,e=this._list;for(this._checkNextAndPrevAble(),this._wrap.get(0).scrollLeft=0,this._listWrap.css("margin-left",-t[0]*this._itemWidth);i!=e.length-2;)if(i<e.length-2)e.pop().remove();else{var s=this.use("common/widget/ImageViewer/ImageNavItem");s.dom.addClass("j_carousel_item"),this._listWrap.append(s.dom),e.push(s)}for(var n=0,a=e.length;a>n;n++){var l=t[0]+n-1;e[n].setData(l)}this.dom.show(),this.trigger("items_builded")},_checkNextAndPrevAble:function(){var t=this._displayRange||this._getDisplayRange();this._prevAble=1*t[0]>0,this._nextAble=1*t[1]<1*this._data.pic_amount-1,this._prevAble?this._prevBtn.css("visibility","inherit"):this._prevBtn.css("visibility","hidden"),this._nextAble?this._nextBtn.css("visibility","inherit"):this._nextBtn.css("visibility","hidden")},_getDisplayRange:function(){if(!this._data)return!1;var t,i,e=this._data.pic_amount,s=Math.min(e,Math.floor((this._width-70)/this._itemWidth),this._maxDisplayAmount);return e>s&&s%2==0&&s--,this._idx>e-1?void 0:(t=Math.max(0,this._idx-Math.floor(s/2)),i=Math.min(t+s-1,e-1),t=Math.max(i-s+1,0),[t,i])},_nextComplete:function(){this._nextStep(),this._checkNextAndPrevAble(),this._isScrolling=!1,this.trigger("next_end",{range:this._displayRange})},_prevComplete:function(){this._prevStep(),this._checkNextAndPrevAble(),this._isScrolling=!1,this.trigger("prev_end",{range:this._displayRange})},_nextStep:function(){var t=-(parseInt(this._listWrap.css("margin-left"))||0);for(this._displayRange;;){var i=this._list[0],e=parseInt(i.dom.css("left"))||0;if(!(Math.round(e+this._itemWidth)<=t))break;i.setData(this._list[this._list.length-1].idx+1),this._list.push(this._list.shift())}this._setItemsActive()},_prevStep:function(){for(var t=-(parseInt(this._listWrap.css("margin-left"))||0),i=this._displayRange;;){var e=this._list[this._list.length-1],s=parseInt(e.dom.css("left"))||0;if(!(Math.round(s)>=t+(i[1]-i[0]+1)*this._itemWidth))break;e.setData(this._list[0].idx-1),this._list.unshift(this._list.pop())}this._setItemsActive()},_toNext:function(t){if(!this._nextAble)return!1;var i=this,e=parseInt(-this._displayRange[0]*this._itemWidth-t*this._itemWidth)||0;return this._listWrap.stop(),this._listWrap.animate({"margin-left":e},{duration:this._scrollSpeed,step:function(){i._nextStep()},complete:function(){i._nextComplete()}}),this.trigger("next_start",{range:this._displayRange}),!0},_toPrev:function(t){if(!this._prevAble)return!1;var i=this,e=parseInt(-this._displayRange[0]*this._itemWidth-t*this._itemWidth)||0;return this._listWrap.stop(),this._listWrap.animate({"margin-left":e},{duration:this._scrollSpeed,step:function(){i._prevStep()},complete:function(){i._prevComplete()}}),this.trigger("prev_start",{range:this._displayRange}),!0},_nextBtnClickHandler:function(){if(!this._isScrolling){var t=this._displayRange,i=t[1]-t[0]+1;this.scroll(i,!0)}},_prevBtnClickHandler:function(){if(!this._isScrolling){var t=this._displayRange,i=t[1]-t[0]+1;this.scroll(-i,!0)}},_itemClickHandler:function(t){this.trigger("normal_state");var i=$.tb.unescapeHTML(t.tbattr("index"));this.trigger("image_select",i)},_setItemsActive:function(){for(var t=0,i=this._list.length;i>t;t++){var e=this._list[t];e.setActive(e.idx==this._idx?!0:!1)}},scroll:function(t,i){if(this._displayRange){var e=this._displayRange[1],s=this._displayRange[0],n=this._data.pic_amount,a=Math.max(Math.min(t,n-1-e),-s);a>0?(this._dc.getGuideList(e,"next"),i&&this._toNext(a)&&(this._isScrolling=!0)):0>a&&(this._dc.getGuideList(s,"prev"),i&&this._toPrev(a)&&(this._isScrolling=!0)),this._displayRange[0]+=a,this._displayRange[1]+=a,i&&this._setItemsActive()}},scrollTo:function(t,i){this._idx=t;var e=this._displayRange,s=e[0]+(e[1]-e[0])/2;this.scroll(t-s,i)},setSize:function(t){this._width=t,this.refresh()},refresh:function(t){"number"==typeof t&&(this._idx=t);var i=this._getDisplayRange();i&&(this._displayRange=i,this._dc.getGuideList(this._displayRange[1],"next"),this._dc.getGuideList(this._displayRange[0],"prev"),this.dom.find(".carousel_ul_wrapper").width(this._itemWidth*(this._displayRange[1]-this._displayRange[0]+1)+2*this._itemPadding),this._buildItems(),this._setItemsActive())}}});
;_.Module.define({path:"common/widget/ImageViewer",requires:["ImageOriginal","ImageNav","ImageComments","DataInterface","DropdownList","TbFav","Hint","Games"],sub:{dom:null,_pageData:{user_id:"",pic_id:"",forum_name:"",forum_name_u:"",tid:"",album_id:"",pn:"",isLogin:!1,isNoUname:!1,isPhotoLiked:!1,tbs:"",forum_id:"",author_name:""},_dc:null,_fullScreenManager:null,_minHeight:512,_minWidth:1024,_original:null,_newGuide:null,_currIndex:null,_nav:null,_tbFav:null,_isBuild:!1,_getCommentDelay:200,_getCommentTimer:null,_commentShowStatus:!0,_commentIsShow:!0,_navShowStatus:!1,_navIsShow:!1,_firstShowImage:!0,_tools:null,_nextAlbumURL:"",_autoCrossTimer:null,initial:function(t,a){t.forum||(t.forum={}),t.forum.name_url=encodeURIComponent($.tb.escapeHTML(t.forum_name)),PageData.forum.name_url=t.forum.name_url,t.forum.name_encode=encodeURIComponent(t.forum_name),$.extend(this._pageData,t);var i=this;i.dom=$('<div class="af_container" ></div>'),i._dc=i.getInstance("common/widget/ImageViewer/DataInterface"),i._dc.bind("guide_ready",i._dataReady,i),i._dc.init(i._pageData,a),i._hint=i.getInstance("common/widget/ImageViewer/Hint"),i._tbFav=i.getInstance("common/widget/ImageViewer/TbFav"),setTimeout(function(){i._buildUI(),i._loadImagePlus()},10)},_loadImagePlus:function(){for(var t,a=this,i=PageUnit.load("image_viewer_imageplus_id"),e=i.split("++"),s=function(t,a){return t&&a&&(t=t.replace(/\uFF0C/g,","),t=","+t+",",a=","+a+",",t.indexOf(a)>-1)?!0:void 0},n=0,o=e.length;o>n;n++){var _=e[n].split("="),d=_[0],r=_[1].split("|"),h=r[0],l=r[1],m=r[2];if(s(h,a._pageData.first_class)||s(l,a._pageData.second_class)||s(m,a._pageData.forum_name)){t=d;break}}t&&(window.baiduImagePlus={unionId:t,imgContainerId:"image_original_container"},window.baiduImagePlusParams={forum_name:a._pageData.forum_name,first_class:a._pageData.first_class,second_class:a._pageData.second_class},$.JLM.use(["http://ecma.bdimg.com/public03/imageplus/tieba_loader.js"],function(){}))},_createRouter:function(){var t=this;window.Path.map("!/pid:pid/pn:pn").to(function(a,i,e){t.action(i,e)}),window.Path.pushState=!1,window.Path.listen()},_changeHash:function(t,a){var i,a=a||1;i="number"==typeof t?this._dc.getPicIdByIndex(t):this._pageData.pic_id,window.Path.isDispatch=!1,window.Path.nav("!/pid"+i+"/pn"+a),setTimeout(function(){window.Path.isDispatch=!0},500)},_hashManager:function(){var t=this;this._comments.bind("change_page",function(a,i){t._changeHash(null,i)})},_dataReady:function(){var t=this;this._currIndex=this._dc.getIndexByPicId(this._pageData.pic_id),this._isBuild||this._buildUI(),this._nav.init(this._currIndex,this.dom.find(".af_nav").width()),this.showImage(this._currIndex),this._resize(),this._initTbFav(),window.Path?(t._createRouter(),t._hashManager()):$.JsLoadManager.use("/tb/static-common/widget/image_viewer/router.js",function(){t._createRouter(),t._hashManager()})},_buildUI:function(){if(!this._isBuild){var t=this;this._original=this.use("ImageOriginal"),this._original.updateByData(this._dc.albumData);var a;a=0===this._pageData.forum_id?'<a title="'+this._pageData.author_name+'\u7684\u4E2A\u4EBA\u4E2D\u5FC3" href="/home/main?un='+encodeURIComponent(this._pageData.author_name)+'&amp;tp=1" target="_blank" class="link_return" >'+$.tb.subByte(this._pageData.author_name,13,"...")+'\u7684\u4E2A\u4EBA\u4E2D\u5FC3</a><span class="af_head_arw" >&gt;</span>':'<a title="'+this._pageData.forum_name+'\u5427" href="/f?kw='+this._pageData.forum.name_encode+'&amp;tp=1" target="_blank" class="link_return" >'+$.tb.subByte(this._pageData.forum_name,13,"...")+'\u5427</a><span class="af_head_arw" >&gt;</span>',this.dom.html(['<div class="af_left"  >','<div class="af_head"  >','<div class="af_head_left" >','<a title="\u767E\u5EA6\u8D34\u5427" href="/tb/picture/index.html" target="_blank" >\u767E\u5EA6\u8D34\u5427</a><span class="af_head_arw" >&gt;</span>',a,'<a href="#" class="link_thread" target="_blank" >\u8D34\u5B50\u539F\u6587</a><span class="af_head_arw" >|</span>','<a href="#" class="link_next" target="_blank" >\u4E0B\u4E00\u56FE\u8D34</a>',"</div>",'<div class="af_head_right" >','<a class="mobile_res" data_type="apk" data_url="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/client/operate/android/tieba_pc_picdownload.apk" data_name="\u767E\u5EA6\u8D34\u5427" data_icon="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/static-album/img/tieba_client.png" data_size="12488145"  data_from="1001714x"  data_versionname="4.4.1"  data_versioncode="4" data_package="com.baidu.tieba" data_detail_type="soft" style="display:none"  ></a>','<a href="#" class="link_share" >\u5206\u4EAB</a>','<a href="#" class="link_autoplay" >\u5E7B\u706F\u64AD\u653E</a>','<span class="link_tools" >\u64CD\u4F5C</span>',"</div>","</div>",'<div class="af_original"  ></div>','<div class="af_nav" >','<div class="af_nav_head" >','<span class="af_nav_num" > <span class="af_nav_status_current" ></span> <span class="af_nav_status_slash" >/</span> <span class="af_nav_status_total"></span> </span>','<span class="af_nav_divider" >|</span>','<span class="af_nav_switch show" >\u663E\u793A\u7F29\u7565\u56FE</span>',"</div>","</div>","</div>",'<div class="af_right" ><a href="#" class="af_right_fold right_close" >&nbsp;</a></div>'].join("")),this.dom.find(".af_original").append(this._original.dom),this._hint.setContainer(this.dom.find(".af_original")),this._comments=this.use("ImageComments",this._pageData),this.dom.find(".af_right").append(this._comments.dom),this._nav=this.use("ImageNav"),this.dom.find(".af_nav").append(this._nav.dom),1==$.cookie("image_nav_show")&&this.displayNav(!0,!0),this._tools=this.use("DropdownList",this.dom.find(".link_tools:first"),{items:[],click:function(a){var i=$(a.target);i.hasClass("af_photo_turn_left")?t._original.rotate(-90):i.hasClass("af_photo_turn_right")?t._original.rotate(90):i.hasClass("af_photo_delete")?t._deletePhotoClickHandler():i.hasClass("af_photo_cover")&&t._setCover(),a.preventDefault()}}),this._setToolsByPower(),this._addShareBtn(),this._resize(),this._bindEvents(),this._addGameLink();var i=this.dom.find(".af_right"),e=this._isMatchWangmeng();if(e){$('<div class="right_wangmeng"><iframe src="//tieba.baidu.com/tb/zt/adsense/wangmeng/?id='+e+"&forumId="+this._pageData.forum_id+'&page=normal&tpl=normal" scrolling="no" frameborder="0" style="width:200px;height:200px;"></iframe></div>').appendTo(i)}this._isBuild=!0}},_isMatchWangmeng:function(){var t,a=this,i=PageUnit.load("image_viewer_right_wangmeng"),e=i.split("=="),s=e[0],n=e[1].split("||"),o=!1,_=function(t,a){return t&&a&&(t=t.replace(/\uFF0C/g,","),t=","+t+",",a=","+a+",",t.indexOf(a)>-1)?!0:void 0},d=n[0],r=n[1],h=n[2];return(_(d,a._pageData.first_class)||_(r,a._pageData.second_class)||_(h,a._pageData.forum_name))&&(o=!0),o&&(t=s),t},_downloatMoblie:function(){var t=this._original.getData().img.original;this.dom.find(".link_dowload_mobile").tbattr({data_name:t.id,data_url:t.url,data_size:t.size,data_icon:t.url});var a=[];$(".mobile_res").each(function(t,i){var e=bdRes2Exe.getPackageByDom(i);e&&a.push(e)}),bd_app_dl(a)},_addGameLink:function(){var t=['<div class="af_head_gamelink">',PageUnit.load("image_viewer_game_link"),"</div>"].join("");this.dom.find(".af_head_left").after(t),this.dom.find(".af_head_gamelink a").css("color",PageUnit.load("image_viewer_game_link_color")),this.dom.find(".af_head_gamelink a").on("click",function(){$.stats.sendRequest("fr=tb0_forum&st_type=recommend&st_value=gametext")})},_setToolsByPower:function(){var t=this._dc.getPower(),a=['<a href="#" class="af_photo_turn_left" >\u5411\u5DE6\u65CB\u8F6C</a>','<a href="#" class="af_photo_turn_right" >\u5411\u53F3\u65CB\u8F6C</a>'];t.setCover&&a.push('<a href="#" class="af_photo_cover" >\u8BBE\u4E3A\u5C01\u9762</a>'),t["delete"]&&a.push('<a href="#" class="af_photo_delete" >\u5220\u9664'+(2==this._dc.albumData.comment_type?"\u56FE\u7247":"\u6B64\u8D34")+"</a>"),this._tools.setItems(a)},_bindEvents:function(){var t=this;$(".af_container").delegate(".af_head_gamelink","click",function(){$.stats.track("\u770B\u56FE\u9875_\u9876\u90E8_\u6587\u5B57\u94FE","PC\u7AEF\u5546\u4E1A\u5316\u6E38\u620F\u7EDF\u8BA1",PageData.product||"","\u70B9\u51FB",{obj_url:"-",obj_name:"-",obj_type:"\u6E38\u620F"})}),this._nav.bind("image_select",function(a,i){t.showImage(i),t._changeHash(this._currIndex,1),t._pageData.pn=1}),this._nav.bind("items_builded",function(){t._resizeComment()}),this._nav.bind("normal_state",function(){t._normalState()}),this._original.bind("image_select",function(a,i,e){t.showImage(i,e),t._changeHash(this._currIndex,1),t._pageData.pn=1}),this._original.bind("next_album",function(){t._nextAlbum()}),this._original.bind("normal_state",function(){t._normalState()}),this._original.bind("cross_head",function(a,i){t._cross("head",i)}),this._original.bind("cross_tail",function(a,i){t._cross("tail",i)}),this.dom.delegate(".af_nav_switch.hide","click",function(a){t.displayNav(!1),a.preventDefault(),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_value=thumbbtnclick")}),this.dom.delegate(".af_nav_switch.show","click",function(a){t.displayNav(!0),a.preventDefault(),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_value=thumbbtnclick")}),this.dom.delegate(".af_right_fold.right_close","click",function(a){t.displayComments(!1),a.preventDefault(),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_value=unfold")}),this.dom.delegate(".af_right_fold.right_open","click",function(a){t.displayComments(!0),a.preventDefault(),$.stats.sendRequest("fr=tb0_forum&st_mod=album&st_value=unfold")}),this.dom.delegate(".link_next","click",function(a){t._original.crossTail(),a.preventDefault()}),this.dom.delegate(".link_autoplay","click",function(a){t._original.toPPTMode(),a.preventDefault()}),this.dom.delegate(".link_dowload_mobile","click",function(){$.stats.sendRequest("fr=tb0_forum&st_mod=picMobile&st_type=image_viewer"),t._downloatMoblie()}),$("body").bind("keyup",function(a){39==a.keyCode&&t._original.next(!0),37==a.keyCode&&t._original.prev(!0),38==a.keyCode&&t.displayNav(),40==a.keyCode&&t.displayComments(),219==a.keyCode&&t.displayNav(),221==a.keyCode&&t.displayComments()}),this._original.bind("to_ppt_mode",function(){t.dom.find(".af_head").hide(),t.displayComments(!1,!0),t.displayNav(!1,!0),t._original.setAutoPlay(!0),t._resize()}),this._original.bind("cancel_ppt_mode",function(){t.dom.find(".af_head").show(),t.displayComments(t._commentShowStatus,!0),t.displayNav(t._navShowStatus,!0),t._original.setAutoPlay(!1),t._resize()}),this._original.bind("show_ui",this._showUIHandler,this),this._original.bind("hide_ui",this._hideUIHandler,this),this._original.bind("restart",this._reset,this),$(window).resize(function(){t._resize()})},_unbindEvents:function(){this._nav.unbind("image_select"),this._original.unbind("image_select"),this._original.unbind("cross_head"),this._original.unbind("cross_tail"),this.dom.undelegate("click"),$("body").unbind("keyup"),this.dom.find(".af_original").unbind("mousewheel")},_showUIHandler:function(){this.dom.find(".af_nav").show(),this.dom.find(".af_right").show()},_hideUIHandler:function(){!this._navIsShow&&this.dom.find(".af_nav").hide(),!this._commentIsShow&&this.dom.find(".af_right").hide()},_cross:function(t,a){var i=this;"tail"==t?i._crossTailState(a):(t="head")?i._prevAlbum():this._showHint("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u5F20\u5566~")},_crossTailState:function(t){var a=this;this._dc.getAlbumRecommend(function(i){var e={kw:a._pageData.forum_name_u,pic_id:t.img.original.id,tid:a._pageData.tid,ntid:i.tid};$.cookie("prev_album",$.json.encode(e)),a._nextAlbumURL=i.url,a._original.crossState(i),a._autoCrossTimer&&(clearTimeout(a._autoCrossTimer),a._autoCrossTimer=null),""!=i.url&&(a._autoCrossTimer=setTimeout(function(){a._nextAlbum()},2e3))})},_normalState:function(){this._nextAlbumURL="",this._dc.abortAlbumRecommendRequest(),this._original.normalState(),clearTimeout(this._autoCrossTimer),this._autoCrossTimer=null},_showHint:function(t,a){this._hint.show(t,a)},_resizeNav:function(){var t=this.dom.find(".af_head"),a=!("none"==t.css("display"));headHeight=a?t.outerHeight():0,nav=this.dom.find(".af_nav"),navBottom=parseInt(nav.css("bottom")),navHeight=nav.height(),originalHeight=this.dom.height()-headHeight-navHeight-navBottom-20,originalWidth=this.dom.find(".af_original").width(),this.dom.find(".af_original").css({top:headHeight,bottom:navHeight+navBottom+30}),this._original.resize(originalWidth,originalHeight),$.browser.msie&&$.browser.version<=6&&this.dom.find(".af_original").css("height",this.dom.height()-navHeight-navBottom-30-t.height())},_resizeComment:function(t){var a=this.dom.find(".af_left"),i=this.dom.find(".af_right"),e=i.outerWidth(),s=this.dom.width(),n=s-e-parseInt(i.css("right")),o=s-e;a.css({width:n}),this.dom.find(".af_nav").css({"padding-right":e,width:n}),this._original.resize(n),t&&this._nav.setSize(o)},_resize:function(){var t=Math.max($(window).width(),this._minWidth),a=Math.max($(window).height(),this._minHeight);this.dom.css({width:t,height:a,top:0,left:0}),this._resizeNav(),this._resizeComment(!0)},_addShareBtn:function(){var t=this;window.bdShare_config_imgshare={type:"collection",pos:"top",hidden:"share collect",content:encodeURIComponent(document.title)},$.JsLoadManager.use("https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/static-common/js/pic_share/imgshare_shell.js?v=1.0",function(){t.dom.find(".link_share").mouseover(function(a){var i=t._original.getData().img.original,e=$(a.target).offset();e.top+=25,bdShare.ImgShare.showHoverPop(i.url,e)}).click(function(){var a=t._original.getData().img.original;bdShare.ImgShare.closeHoverPop(),bdShare.ImgShare.showAllPop(a.url)}),t.dom.delegate(".af_head_right a","mouseenter",function(){var t=$(this);t.hasClass("link_share")||bdShare.ImgShare.closeHoverPop()})})},_initTbFav:function(){var t=this.getInstance("common/widget/ImageViewer/TbFav"),a={userId:this._pageData.user_id};t.setConf(a);var i={tags:"\u767E\u5EA6\u8D34\u5427,"+this._pageData.forum_name+"\u5427"};t.setData(i);var e=this;t.bind("check_status_success",function(t,a){e._likeCheckStatusSuccessHanlder(a)}),t.bind("add_to_fav_success",function(t,a){e._likeAddToFavSuccessHandler(a)}),this._tbFav=t},_likeClickHandler:function(){return this._pageData.isLogin?void(this._pageData.isPhotoLiked?($.stats.sendRequest("fr=tb0_forum&st_mod=shoucang&st_value=xiangce"),window.open("http://xiangce.baidu.com/opencom/picture/fav/rewrite")):(this._tbFav.addToFav(),$.stats.sendRequest("fr=tb0_forum&st_mod=albumshoucang&st_value=click"))):void TbCom.process("User","buildLoginFrame",null,null,null,"fav_img")},_likeCheckStatus:function(){var t=(this._data,this);this._dc.getImageGuideByIndex(this._currIndex,function(a){var i={sourceURL:$.tb.location.getHref(),imgUrl:a.img.original.url,descript:$.tb.subByte(t._dc.albumData.title,40,"")};t._tbFav.checkStatus(i)})},_likeCheckStatusSuccessHanlder:function(t){var a=this.dom.find(".link_fav");"hit_cache"==t||0==t.errno&&t.data&&0!=t.data.status?(this._pageData.isPhotoLiked=!0,a.addClass("done").html("\u5DF2\u6536\u85CF").tbattr("title","\u67E5\u770B\u5DF2\u6536\u85CF\u56FE\u7247")):(this._pageData.isPhotoLiked=!1,a.addClass("done").html("\u6536\u85CF").tbattr("title","\u6536\u85CF\u5230\u767E\u5EA6\u76F8\u518C"))},_likeAddToFavSuccessHandler:function(t){var a=this.dom.find(".link_fav");switch(t.errno){case 0:this._pageData.isPhotoLiked=!0,a.addClass("done").html("\u5DF2\u6536\u85CF").tbattr("title","\u67E5\u770B\u5DF2\u6536\u85CF\u56FE\u7247"),"1"==$.cookie("ablum_hls")?this._showHint("\u5DF2\u6536\u85CF\u5230\u767E\u5EA6\u76F8\u518C"):(this._showHint('\u4F7F\u7528\u4E91\u76F8\u518C\u6536\u85CF\u5DE5\u5177\uFF0C\u6279\u91CF\u6536\u85CF\u7CBE\u7F8E\u56FE\u7247\uFF01<a target="_blank" href="http://xiangce.baidu.com/tool/shoucang/">\u7ACB\u5373\u5B89\u88C5</a>',function(){},{time:5e3}),$.cookie("ablum_hls","1",{expires:30}));break;case 20026:TbCom.process("User","buildLoginFrame",null,null,null,"fav_img");break;case 20027:default:return void this._showHint("\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01")}},_displayCommentsComplete:function(t){var a=this,i=a.dom.find(".af_right_fold:first");a._resizeComment(!1),t?(i.addClass("right_close").removeClass("right_open"),a._comments.update(null,null,!0)):i.addClass("right_open").removeClass("right_close")},_displayNavComplete:function(t){var a=this,i=a.dom.find(".af_nav_switch:first");t?(i.text("\u9690\u85CF\u7F29\u7565\u56FE"),i.addClass("hide").removeClass("show"),this._nav.refresh()):(i.text("\u663E\u793A\u7F29\u7565\u56FE"),i.addClass("show").removeClass("hide"))},_deletePhotoClickHandler:function(){var t='<div class="del_pop_wrapper"><p class="del_pop_title">\u4F60\u786E\u5B9A\u8981\u5220\u9664\u672C\u56FE\u6240\u5728\u8D34\u5B50\uFF1F</p><p>\u63D0\u793A\uFF1A\u5C06\u5220\u9664\u8BE5\u56FE\u7247\u6240\u5728\u8D34\u5B50\uFF0C\u53EF\u80FD\u5305\u542B\u5176\u4ED6\u5185\u5BB9</p></div>',a="\u5220\u9664\u8D34\u5B50";2==this._dc.albumData.comment_type&&(t='<div class="del_pop_wrapper"><p class="del_pop_title">\u4F60\u786E\u5B9A\u8981\u5220\u9664\u6B64\u56FE\u7247?</p><p>\u63D0\u793A\uFF1A\u8BE5\u56FE\u7247\u6240\u6709\u8BC4\u8BBA\u4E5F\u4F1A\u4E00\u540C\u5220\u9664</p></div>',a="\u5220\u9664\u56FE\u7247");var i=$.dialog.confirm(t,{title:a}),e=this;i.bind("onaccept",function(){e._deletePhoto()})},_deletePhoto:function(){var t=this,a=t._dc.guide.pic_amount;t._dc.deletePhoto(function(i){0==i?t._exit():1==i?a>1?t._reset():t._exit():2==i&&(a>1?t._reset():t._exit())})},_setCover:function(){var t=this;t._dc.setCover(this._pageData.pic_id,function(a){var i;i=a?"\u5C01\u9762\u8BBE\u7F6E\u6210\u529F!":"\u5C01\u9762\u8BBE\u7F6E\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5~",t._showHint(i)})},_exit:function(){$.tb.location.setHref("/f?kw="+this._pageData.forum_name_u+"&tp=1")},_reset:function(){$.tb.location.setHref("/photo/p?kw="+this._pageData.forum.name_url+"&tid="+this._pageData.tid)},_nextAlbum:function(){this._nextAlbumURL&&""!=this._nextAlbumURL&&$.tb.location.setHref(this._nextAlbumURL)},_prevAlbum:function(){var t=this,a=$.cookie("prev_album");if(a&&""!=a){$.cookie("prev_album","");var i=$.json.decode(a);if(i.ntid==t._pageData.tid){var e="/photo/p?kw="+encodeURIComponent(i.kw)+"&tid="+i.tid+"&pic_id="+i.pic_id+"&pn=1&see_lz=0#!/pid"+i.pic_id+"/pn1";$.tb.location.setHref(e)}else this._showHint("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u5F20\u5566~")}else this._showHint("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u5F20\u5566~")},action:function(t,a){this._pageData.pic_id=t,this._pageData.pn=a||1;var i=this._dc.getIndexByPicId(t);this.showImage(i)},showImage:function(t,a){var i=this;a=void 0==a||1==a?1:0,this._currIndex=t,this.dom.find(".af_nav_status_current").text(1*t+1),this.dom.find(".af_nav_status_total").text(this._dc.guide.pic_amount);var e=this._dc.getImageGuideByIndex(this._currIndex);!e&&this._showHint("\u6B63\u5728\u52AA\u529B\u7684\u83B7\u53D6\u6570\u636E\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85~"),this._dc.getImageGuideByIndex(this._currIndex,function(a){var e="/p/"+i._pageData.tid+"?fid="+i._pageData.forum_id;e+=2==i._dc.albumData.comment_type?"":"&pid="+a.post_id+"#"+a.post_id,i.dom.find(".link_thread").tbattr("href",e),i._pageData.pic_id=a.img.original.id,i._original.update(t),i._nav.scrollTo(t,!0),i._likeCheckStatus()}),this._getCommentTimer&&(clearTimeout(this._getCommentTimer),this._getCommentTimer=null),a&&(this._getCommentTimer=setTimeout(function(){i._dc.getCommentList(t,i._pageData.pn,function(t,a){i._comments.update(t.data,a,i._commentIsShow),i._setToolsByPower(),i._getCommentTimer=null},i._firstShowImage),i._firstShowImage&&(i._firstShowImage=!1)},this._getCommentDelay))},displayNav:function(t,a){if(this._navIsShow!==t){var t="boolean"==typeof t?t:!this._navIsShow;this._navIsShow=t,a||(this._navShowStatus=t,$.cookie("image_nav_show",t?1:0));var i=this.dom.find(".af_nav"),e=t?0:-i.height(),s=this;t&&i.show(),i.stop(),a?(i.css("bottom",e),s._resizeNav(),s._displayNavComplete(t)):i.animate({bottom:e},{step:function(){s._resizeNav()},complete:function(){s._displayNavComplete(t),s._resizeNav()}})}},displayComments:function(t,a){if(this._commentIsShow!==t){var t="boolean"==typeof t?t:!this._commentIsShow;this._commentIsShow=t,a||(this._commentShowStatus=t);var i=this.dom.find(".af_right"),e=t?0:-i.outerWidth(),s=this;t&&i.show(),i.stop(),a?(i.css("right",e),s._displayCommentsComplete(t)):i.animate({right:e},{step:function(){s._resizeComment(!1)},complete:function(){s._displayCommentsComplete(t),s._resizeComment(!1)}})}}}});
;_.Module.define({path:"common/widget/ImageViewer/ImageFilterUser",requires:["common/widget/BlockUser"],sub:{initial:function(){var t=this,e=function(){function i(){var t=['<div id="filter_pop">'],e="get_ip_tbs"==a.type,i=r.is_phone_ip,p=a.can_prison_ip;e?p?(t.push("<table><thead><tr><td>\u7528\u6237\u540D</td><td>\u5C01\u7981\u65F6\u957F</td><td>\u64CD\u4F5C</td></tr></thead><tbody><tr><td>"),t.push(a.user_name),t.push("</td>"),t.push('<td><select id="select_ban_days" size="1"><option selected="" value="1">1</option><option value="3">3</option><option value="10">10</option></select>&nbsp;\u5929</td>'),t.push('<td><input type="button" onclick="album_filter_user.filter_forum_user();" value="\u5C01\u7981ID"></td></tr>'),t.push("<tr><td></td>"),t.push("<td></td>"),t.push('<td><input id="ban_ip_button" onclick="album_filter_user.filter_both();" type="button" value="\u5C01\u7981ID/IP"></td></tr></tbody></table>'),t.push('<p id="filter_phone_ip_info">\u624B\u673AIP\u65E0\u6CD5\u5C01\u7981</p>'),t.push('<p id="filter_ip_info" class="gray">*  IP\u5C01\u7981\u9ED8\u8BA4\u4E3A1\u5929</p>')):(t.push("<table><thead><tr><td>\u7528\u6237\u540D</td><td>\u5C01\u7981\u65F6\u957F</td><td>\u64CD\u4F5C</td></tr></thead><tbody><tr><td>"),t.push(a.user_name),t.push("</td>"),t.push("<td>1\u5929</td>"),t.push('<td><input type="button" onclick="album_filter_user.filter_forum_user();" value="\u5C01\u7981ID"></td></tr>'),t.push("</tbody></table>")):(t.push("<table><thead><tr><td>\u7528\u6237\u540D</td><td>\u5C01\u7981\u65F6\u957F</td><td>\u64CD\u4F5C</td></tr></thead><tbody>"),t.push("<tr><td>"+n+"</td>"),t.push("<td>1 \u5929</td>"),t.push('<td><input id="ban_ip_button" onclick="album_filter_user.filter_forum_ip();" type="button" value="\u5C01\u7981IP"></td></tr></tbody></table>'),t.push('<p id="filter_phone_ip_info">\u624B\u673AIP\u65E0\u6CD5\u5C01\u7981</p>')),t.push("</div>"),u=new $.dialog({html:t.join(""),title:"\u5C01\u7981\u64CD\u4F5C",width:375}),i&&($("#ban_ip_button").css({display:"none"}),$("#filter_phone_ip_info").css({visibility:"visible"}))}function p(t){if(u&&$("#filter_pop"))switch(t.error.errno){case 0:$("#filter_pop").html('<p style="font-size:14px;text-align:center;padding-top:30px">\u5C01\u7981\u6210\u529F!</p>'),setTimeout(function(){u.close()},600);break;case 14:$("#filter_pop").html('<p style="font-size:14px;text-align:center;padding-top:30px;line-height:24px;">'+t.error.errmsg+"</p>")}}var r=null,a={},n="",u=null;return{filter_forum_user:function(){t.requireInstanceAsync("common/widget/BlockUser",[[{username:a.user_name,pid:a.pid}],{ban_ip:PageData.power.ban_ip,ban_id:PageData.power.ban_id},{forum_name:PageData.forum_name,forum_id:PageData.forum_id},PageData.tbs])},filter_both:function(){e.filter_forum_user(),e.filter_forum_ip()},filter_forum_ip:function(){var t={cm:"filter_forum_ip",user_ip:r.ip_int,ip_secure_str:r.ip_secure_str,ban_days:1,word:PageData.forum_name||PageData.forum.name,fid:PageData.forum_id||PageData.forum.id,tbs:r.tbs_ban_ip,ie:"utf-8"};$.post("/bawu/cm",t,function(t){r=$.parseJSON(t),p(r)})},get_ip_tbs:function(t,e,p,u,o,d){n=t,a={type:o,tid:u,pid:u,ip:e,ip_int:p,user_name:t,post_id:u,word:PageData.forum_name||PageData.forum.name,fid:PageData.forum_id||PageData.forum.id,can_prison_ip:d,ie:"utf-8"};var _=a;"get_tbs"==_.type&&(_.user_name=_.ip_int),delete _.ip,delete _.ip_int,$.get("/bawu2/filter/getIpTbs",_,function(t){r=$.parseJSON(t),"get_post_ip"==_.type&&(r.ip_secure_str=""),i()})}}}()}}});